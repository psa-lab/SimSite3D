<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>simsite3d: ASCbase::mol2File Class Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.4.7 -->
<div class="tabs">
  <ul>
    <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
    <li id="current"><a href="annotated.html"><span>Classes</span></a></li>
    <li><a href="files.html"><span>Files</span></a></li>
  </ul></div>
<div class="tabs">
  <ul>
    <li><a href="annotated.html"><span>Class&nbsp;List</span></a></li>
    <li><a href="hierarchy.html"><span>Class&nbsp;Hierarchy</span></a></li>
    <li><a href="functions.html"><span>Class&nbsp;Members</span></a></li>
  </ul></div>
<div class="nav">
<b>ASCbase</b>::<a class="el" href="classASCbase_1_1mol2File.html">mol2File</a></div>
<h1>ASCbase::mol2File Class Reference</h1><!-- doxytag: class="ASCbase::mol2File" --><!-- doxytag: inherits="ASCbase::CoordFile" -->Read and write mol2 files and perform various operations.  
<a href="#_details">More...</a>
<p>
<code>#include &lt;<a class="el" href="mol2File_8H-source.html">mol2File.H</a>&gt;</code>
<p>
<p>Inheritance diagram for ASCbase::mol2File:
<p><center><img src="classASCbase_1_1mol2File.png" usemap="#ASCbase::mol2File_map" border="0" alt=""></center>
<map name="ASCbase::mol2File_map">
<area href="classASCbase_1_1CoordFile.html" alt="ASCbase::CoordFile" shape="rect" coords="0,0,127,24">
</map>
<a href="classASCbase_1_1mol2File-members.html">List of all members.</a><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classASCbase_1_1mol2File.html#9abfe2130ac705d98538e620541dbc28">mol2File</a> (const std::string filename, const verbose_level_t verbosity=VERBOSE_SILENT)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Constructor -- reads in the file and sets up the structure.  <a href="#9abfe2130ac705d98538e620541dbc28"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classASCbase_1_1mol2File.html#b890d66be2effc7b300ec625c87a014c">mol2File</a> (const <a class="el" href="classASCbase_1_1mol2File.html">mol2File</a> &amp;src, const <a class="el" href="classASCbase_1_1BoundingVolume.html">BoundingVolume</a> &amp;site_vol, const <a class="el" href="classASCbase_1_1CoordFile.html">CoordFile</a> &amp;prot_atoms, const uint min_num_atoms, const my_float_t *R, const my_float_t *T)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Copy constructor -- fragments the ligand.  <a href="#b890d66be2effc7b300ec625c87a014c"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="c3c8ecaa09091961a32c131c2e9199f3"></a><!-- doxytag: member="ASCbase::mol2File::~mol2File" ref="c3c8ecaa09091961a32c131c2e9199f3" args="()" -->
&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classASCbase_1_1mol2File.html#c3c8ecaa09091961a32c131c2e9199f3">~mol2File</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Do nothin dstor. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classASCbase_1_1mol2File.html#8621701ac72363cd41e08123cb4929af">report_stats</a> (std::ostream &amp;out)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Each derived class should support some routine to report on the file.  <a href="#8621701ac72363cd41e08123cb4929af"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="4df38db9db07af42b91db5fd0519d78a"></a><!-- doxytag: member="ASCbase::mol2File::revert_positions" ref="4df38db9db07af42b91db5fd0519d78a" args="()" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classASCbase_1_1mol2File.html#4df38db9db07af42b91db5fd0519d78a">revert_positions</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Set the current positions to those read from file (original positions). <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classASCbase_1_1mol2File.html#050d5348e9f9a59de0949a66acab96de">write</a> (std::string ofname)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Write the molecule(s) to the specified file.  <a href="#050d5348e9f9a59de0949a66acab96de"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="ac4b079f975345f69ad63b689f6bb3f5"></a><!-- doxytag: member="ASCbase::mol2File::num_heavy_atoms" ref="ac4b079f975345f69ad63b689f6bb3f5" args="()" -->
const uint&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classASCbase_1_1mol2File.html#ac4b079f975345f69ad63b689f6bb3f5">num_heavy_atoms</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get the number of heavy atoms in the molecule(s). <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">std::vector&lt; bool &gt;::const_iterator&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classASCbase_1_1mol2File.html#27ca8161c7d240a8331a56912047dde0">frag_atoms_flags_beg</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">std::vector&lt; bool &gt;::const_iterator&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classASCbase_1_1mol2File.html#a7662a32085ef964254c0f36285f9fb0">frag_atoms_flags_end</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">const std::vector&lt; atom_vci &gt; &amp;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classASCbase_1_1mol2File.html#c112d4a0eaca36f7ffa1d635ab30a13f">get_nbrs</a> (const atom_vci atom) const </td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="a835e7086af8dd4ea8e315b58666324d"></a><!-- doxytag: member="ASCbase::mol2File::atom_type_to_str" ref="a835e7086af8dd4ea8e315b58666324d" args="(const atom_vci atom)" -->
std::string&nbsp;</td><td class="memItemRight" valign="bottom"><b>atom_type_to_str</b> (const atom_vci atom)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="cd1b6001933a4461f79c35d2ed482daa"></a><!-- doxytag: member="ASCbase::mol2File::calc_charge_sums" ref="cd1b6001933a4461f79c35d2ed482daa" args="()" -->
bool&nbsp;</td><td class="memItemRight" valign="bottom"><b>calc_charge_sums</b> ()</td></tr>

<tr><td colspan="2"><br><h2>Private Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classASCbase_1_1mol2File.html#da164682f58d1e4539666d13de03fb9a">read_data</a> (std::ifstream &amp;mol2_file)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="89e45a813cec79c2e095a5bfd8a77f67"></a><!-- doxytag: member="ASCbase::mol2File::read_molecule_section" ref="89e45a813cec79c2e095a5bfd8a77f67" args="(std::ifstream &amp;mol2_file, uint *num_atoms_out, uint *num_bonds_out)" -->
bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classASCbase_1_1mol2File.html#89e45a813cec79c2e095a5bfd8a77f67">read_molecule_section</a> (std::ifstream &amp;mol2_file, uint *num_atoms_out, uint *num_bonds_out)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Read the first molecule section. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="01383b135389cc03960445865d57fe87"></a><!-- doxytag: member="ASCbase::mol2File::read_atom_section" ref="01383b135389cc03960445865d57fe87" args="(std::ifstream &amp;mol2_file, const uint num_atoms)" -->
bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classASCbase_1_1mol2File.html#01383b135389cc03960445865d57fe87">read_atom_section</a> (std::ifstream &amp;mol2_file, const uint num_atoms)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Read the first atom section after the first molecule section. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="aebc4bf5f53617b0e6014300bd40e608"></a><!-- doxytag: member="ASCbase::mol2File::read_bond_section" ref="aebc4bf5f53617b0e6014300bd40e608" args="(std::ifstream &amp;mol2_file, const uint num_bonds)" -->
bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classASCbase_1_1mol2File.html#aebc4bf5f53617b0e6014300bd40e608">read_bond_section</a> (std::ifstream &amp;mol2_file, const uint num_bonds)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Read the first bond section after the first atom section. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="d8c08befaed6c64a8752e5f6f43b63f0"></a><!-- doxytag: member="ASCbase::mol2File::look_up_atom_by_string" ref="d8c08befaed6c64a8752e5f6f43b63f0" args="(const std::string atom_str, atom_t *atom)" -->
bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classASCbase_1_1mol2File.html#d8c08befaed6c64a8752e5f6f43b63f0">look_up_atom_by_string</a> (const std::string atom_str, <a class="el" href="classASCbase_1_1atom__t.html">atom_t</a> *atom)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Given mol2 atom and orbital string, get internal info on atom. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="632bf1f1d3c95fd67ab1799753309a78"></a><!-- doxytag: member="ASCbase::mol2File::look_up_bond_by_string" ref="632bf1f1d3c95fd67ab1799753309a78" args="(const std::string bond_str, mol2_bond_t *bond)" -->
bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classASCbase_1_1mol2File.html#632bf1f1d3c95fd67ab1799753309a78">look_up_bond_by_string</a> (const std::string bond_str, <a class="el" href="structASCbase_1_1mol2__bond__t.html">mol2_bond_t</a> *bond)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Given mol2 bond string, get internal bond type. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="29239519d712966a47a89c6658952ade"></a><!-- doxytag: member="ASCbase::mol2File::init_atom_table_by_string" ref="29239519d712966a47a89c6658952ade" args="()" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classASCbase_1_1mol2File.html#29239519d712966a47a89c6658952ade">init_atom_table_by_string</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Setup the map used to look up atom info based on mol2 atom and orbital. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="2cf17eb0c5a571259113af56b98ef615"></a><!-- doxytag: member="ASCbase::mol2File::init_bond_table_by_string" ref="2cf17eb0c5a571259113af56b98ef615" args="()" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classASCbase_1_1mol2File.html#2cf17eb0c5a571259113af56b98ef615">init_bond_table_by_string</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Setup the map to convert from mol2 bond string to internal bond type. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="3bc5899510eadb43c23f2ab11393baa9"></a><!-- doxytag: member="ASCbase::mol2File::init_bond_types_to_str" ref="3bc5899510eadb43c23f2ab11393baa9" args="()" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classASCbase_1_1mol2File.html#3bc5899510eadb43c23f2ab11393baa9">init_bond_types_to_str</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Setup the map to convert from interal bond type to mol2 bond string. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classASCbase_1_1mol2File.html#d0e57ec2d4706d8b22375a55aed5d71e">init_atom_types_to_str</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="e16024d1b4aa6847320f9014ef056929"></a><!-- doxytag: member="ASCbase::mol2File::add_bond" ref="e16024d1b4aa6847320f9014ef056929" args="(const uint a1, const uint a2, const bond_type type, const std::string status_bits)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><b>add_bond</b> (const uint a1, const uint a2, const bond_type type, const std::string status_bits)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="c82eec85dee77e4c25da6d769f7d4c0e"></a><!-- doxytag: member="ASCbase::mol2File::assign_act_types" ref="c82eec85dee77e4c25da6d769f7d4c0e" args="()" -->
bool&nbsp;</td><td class="memItemRight" valign="bottom"><b>assign_act_types</b> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="cb742dce4a6b0b2ecc060efa71831672"></a><!-- doxytag: member="ASCbase::mol2File::generate_nbrs_vec" ref="cb742dce4a6b0b2ecc060efa71831672" args="()" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><b>generate_nbrs_vec</b> ()</td></tr>

<tr><td colspan="2"><br><h2>Private Attributes</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="4a239c4b6ef9219e5a6e1bcaf24abd6b"></a><!-- doxytag: member="ASCbase::mol2File::A_mol_name" ref="4a239c4b6ef9219e5a6e1bcaf24abd6b" args="" -->
std::string&nbsp;</td><td class="memItemRight" valign="bottom"><b>A_mol_name</b></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="0c181617cd1dfdba0349866cd0c50228"></a><!-- doxytag: member="ASCbase::mol2File::A_mol_type" ref="0c181617cd1dfdba0349866cd0c50228" args="" -->
std::string&nbsp;</td><td class="memItemRight" valign="bottom"><b>A_mol_type</b></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="26ec305f2afdc4dcc89b393583a1a3ff"></a><!-- doxytag: member="ASCbase::mol2File::A_charge_type" ref="26ec305f2afdc4dcc89b393583a1a3ff" args="" -->
std::string&nbsp;</td><td class="memItemRight" valign="bottom"><b>A_charge_type</b></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="fe494476e111dd553575e619b05c152c"></a><!-- doxytag: member="ASCbase::mol2File::atoms_by_type_str" ref="fe494476e111dd553575e619b05c152c" args="" -->
std::map&lt; std::string, const <br>
mol2_atom_info_t * &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><b>atoms_by_type_str</b></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="109be33ef75390bd6ecfd089047d089d"></a><!-- doxytag: member="ASCbase::mol2File::bonds_by_type_str" ref="109be33ef75390bd6ecfd089047d089d" args="" -->
std::map&lt; std::string, bond_type &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><b>bonds_by_type_str</b></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="272cffb8d8134d3479509dffd2d713c7"></a><!-- doxytag: member="ASCbase::mol2File::bond_types_to_str" ref="272cffb8d8134d3479509dffd2d713c7" args="" -->
std::map&lt; bond_type, std::string &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><b>bond_types_to_str</b></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="e2f2b5510e400d2f8bffb5f4960a70f7"></a><!-- doxytag: member="ASCbase::mol2File::atom_types_to_str" ref="e2f2b5510e400d2f8bffb5f4960a70f7" args="" -->
std::map&lt; atom_type, std::map&lt;<br>
 orbit_type, std::string &gt; &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><b>atom_types_to_str</b></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="fac5b8259ea43796ddf98642432d513b"></a><!-- doxytag: member="ASCbase::mol2File::rest_of_lines" ref="fac5b8259ea43796ddf98642432d513b" args="" -->
std::vector&lt; std::string &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><b>rest_of_lines</b></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="1a674f42d6702f792adfa852a48f24eb"></a><!-- doxytag: member="ASCbase::mol2File::bonds" ref="1a674f42d6702f792adfa852a48f24eb" args="" -->
mol2_bond_vec&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classASCbase_1_1mol2File.html#1a674f42d6702f792adfa852a48f24eb">bonds</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Rest of the atom lines. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="799f9c155bbe3f70a26fd8a2cfa2b3ab"></a><!-- doxytag: member="ASCbase::mol2File::atom_ids_are_consecutive" ref="799f9c155bbe3f70a26fd8a2cfa2b3ab" args="" -->
bool&nbsp;</td><td class="memItemRight" valign="bottom"><b>atom_ids_are_consecutive</b></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="c3b92d4de315f32a750cf70bf3e776a5"></a><!-- doxytag: member="ASCbase::mol2File::is_frag_file" ref="c3b92d4de315f32a750cf70bf3e776a5" args="" -->
bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classASCbase_1_1mol2File.html#c3b92d4de315f32a750cf70bf3e776a5">is_frag_file</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">True if the molecule is a fragment, else false. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="4ed3d8244528aa77369514f27b4d417d"></a><!-- doxytag: member="ASCbase::mol2File::a_num_heavy_atoms" ref="4ed3d8244528aa77369514f27b4d417d" args="" -->
uint&nbsp;</td><td class="memItemRight" valign="bottom"><b>a_num_heavy_atoms</b></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="ce4ef757c3a959846fc802b6c9ac5cf7"></a><!-- doxytag: member="ASCbase::mol2File::frag_atoms" ref="ce4ef757c3a959846fc802b6c9ac5cf7" args="" -->
std::vector&lt; bool &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classASCbase_1_1mol2File.html#ce4ef757c3a959846fc802b6c9ac5cf7">frag_atoms</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Bool string of atoms present in fragment. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="5527c87e8143a7c1d88929a5059f21e5"></a><!-- doxytag: member="ASCbase::mol2File::A_nbrs_vec" ref="5527c87e8143a7c1d88929a5059f21e5" args="" -->
std::vector&lt; std::vector&lt;<br>
 atom_vci &gt; &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><b>A_nbrs_vec</b></td></tr>

<tr><td colspan="2"><br><h2>Static Private Attributes</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="64a9ac2baaaca25e2390a71920193994"></a><!-- doxytag: member="ASCbase::mol2File::ATOMS_TOO_FAR" ref="64a9ac2baaaca25e2390a71920193994" args="" -->
static const my_float_t&nbsp;</td><td class="memItemRight" valign="bottom"><b>ATOMS_TOO_FAR</b> = 4.5</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="d4e8c046a3d397bb31c2e490bbde6827"></a><!-- doxytag: member="ASCbase::mol2File::ATOMS_TOO_CLOSE" ref="d4e8c046a3d397bb31c2e490bbde6827" args="" -->
static const my_float_t&nbsp;</td><td class="memItemRight" valign="bottom"><b>ATOMS_TOO_CLOSE</b> = 1.75</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="b7069d02b480b1de4486d2a9c5665fa1"></a><!-- doxytag: member="ASCbase::mol2File::_fname" ref="b7069d02b480b1de4486d2a9c5665fa1" args="" -->
static const std::string&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classASCbase_1_1mol2File.html#b7069d02b480b1de4486d2a9c5665fa1">_fname</a> = &quot;mol2File.C&quot;</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Name of source file. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="f3f904ef0e8e6cd03c3eadb901a83534"></a><!-- doxytag: member="ASCbase::mol2File::MINIMAL_CHARGE" ref="f3f904ef0e8e6cd03c3eadb901a83534" args="" -->
static const my_float_t&nbsp;</td><td class="memItemRight" valign="bottom"><b>MINIMAL_CHARGE</b> = 0.5</td></tr>

<tr><td colspan="2"><br><h2>Classes</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structASCbase_1_1mol2File_1_1nbr__bond__type.html">nbr_bond_type</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Simple temporary type to store bond info in a vector.  <a href="structASCbase_1_1mol2File_1_1nbr__bond__type.html#_details">More...</a><br></td></tr>
</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
Read and write mol2 files and perform various operations. 
<p>
This class has 2 constructors. The first is to read the molecule(s) from a given file. The second constructor is a copy constructor and requires a protein and sitemap. This copy constructor discards all ligand atoms (in the copy) that are not within 2.0 (A) of any template point. These atoms are then checked to ensure that they do not significantly overlap with the protein. All of the ligand fragments are checked to ensure that they each have at least N connected heavy atoms. 
<p>
<hr><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" name="9abfe2130ac705d98538e620541dbc28"></a><!-- doxytag: member="ASCbase::mol2File::mol2File" ref="9abfe2130ac705d98538e620541dbc28" args="(const std::string filename, const verbose_level_t verbosity=VERBOSE_SILENT)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">mol2File::mol2File           </td>
          <td>(</td>
          <td class="paramtype">const std::string&nbsp;</td>
          <td class="paramname"> <em>filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const verbose_level_t&nbsp;</td>
          <td class="paramname"> <em>verbosity</em> = <code>VERBOSE_SILENT</code></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Constructor -- reads in the file and sets up the structure. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>filename</em>&nbsp;</td><td>Path of the mol2 file to read </td></tr>
  </table>
</dl>

</div>
</div><p>
<a class="anchor" name="b890d66be2effc7b300ec625c87a014c"></a><!-- doxytag: member="ASCbase::mol2File::mol2File" ref="b890d66be2effc7b300ec625c87a014c" args="(const mol2File &amp;src, const BoundingVolume &amp;site_vol, const CoordFile &amp;prot_atoms, const uint min_num_atoms, const my_float_t *R, const my_float_t *T)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">mol2File::mol2File           </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classASCbase_1_1mol2File.html">mol2File</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>src</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classASCbase_1_1BoundingVolume.html">BoundingVolume</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>site_vol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classASCbase_1_1CoordFile.html">CoordFile</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>prot_atoms</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint&nbsp;</td>
          <td class="paramname"> <em>min_num_atoms</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const my_float_t *&nbsp;</td>
          <td class="paramname"> <em>R</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const my_float_t *&nbsp;</td>
          <td class="paramname"> <em>T</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Copy constructor -- fragments the ligand. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>src</em>&nbsp;</td><td>Reference to the full ligand to copy (search ligand) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>site_vol</em>&nbsp;</td><td>Reference to the sitemap volume estimate </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>prot_atoms</em>&nbsp;</td><td>Reference to the query protein atoms </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>min_num_atoms</em>&nbsp;</td><td>Minimum number of atoms in a ligand fragment </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>R</em>&nbsp;</td><td>Rotation matrix to move ligand to the model ref. frame </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>T</em>&nbsp;</td><td>Translation vector to move ligand to the model ref. frame </td></tr>
  </table>
</dl>

</div>
</div><p>
<hr><h2>Member Function Documentation</h2>
<a class="anchor" name="27ca8161c7d240a8331a56912047dde0"></a><!-- doxytag: member="ASCbase::mol2File::frag_atoms_flags_beg" ref="27ca8161c7d240a8331a56912047dde0" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;bool&gt;::const_iterator ASCbase::mol2File::frag_atoms_flags_beg           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
The vector referred to is of the same length as the number of atoms in the "original" ligand. The nth bool is true or false if the nth ligand atom is in a ligand fragment or is not in a ligand fragment respectively. 
</div>
</div><p>
<a class="anchor" name="a7662a32085ef964254c0f36285f9fb0"></a><!-- doxytag: member="ASCbase::mol2File::frag_atoms_flags_end" ref="a7662a32085ef964254c0f36285f9fb0" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;bool&gt;::const_iterator ASCbase::mol2File::frag_atoms_flags_end           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Get a const iterator to the end of the boolean vector denoting which atoms of the full ligand were kept. 
</div>
</div><p>
<a class="anchor" name="c112d4a0eaca36f7ffa1d635ab30a13f"></a><!-- doxytag: member="ASCbase::mol2File::get_nbrs" ref="c112d4a0eaca36f7ffa1d635ab30a13f" args="(const atom_vci atom) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const std::vector&lt;atom_vci&gt;&amp; ASCbase::mol2File::get_nbrs           </td>
          <td>(</td>
          <td class="paramtype">const atom_vci&nbsp;</td>
          <td class="paramname"> <em>atom</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Get the neighbors of atom in this molecule. If someone wants to pass in an atom from another molecule, they will get rewarded with a const ref to an empty vector. 
</div>
</div><p>
<a class="anchor" name="d0e57ec2d4706d8b22375a55aed5d71e"></a><!-- doxytag: member="ASCbase::mol2File::init_atom_types_to_str" ref="d0e57ec2d4706d8b22375a55aed5d71e" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void mol2File::init_atom_types_to_str           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Setup the map to convert from internal atom and orbital to mol2 atom string 
</div>
</div><p>
<a class="anchor" name="da164682f58d1e4539666d13de03fb9a"></a><!-- doxytag: member="ASCbase::mol2File::read_data" ref="da164682f58d1e4539666d13de03fb9a" args="(std::ifstream &amp;mol2_file)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool mol2File::read_data           </td>
          <td>(</td>
          <td class="paramtype">std::ifstream &amp;&nbsp;</td>
          <td class="paramname"> <em>mol2_file</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"><code> [private, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Top level read function -- read in the molecule(s) from the file passed to the constructor 
<p>
Implements <a class="el" href="classASCbase_1_1CoordFile.html#1fdc54fd347269643062dee5418859a5">ASCbase::CoordFile</a>.
</div>
</div><p>
<a class="anchor" name="8621701ac72363cd41e08123cb4929af"></a><!-- doxytag: member="ASCbase::mol2File::report_stats" ref="8621701ac72363cd41e08123cb4929af" args="(std::ostream &amp;out)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void mol2File::report_stats           </td>
          <td>(</td>
          <td class="paramtype">std::ostream &amp;&nbsp;</td>
          <td class="paramname"> <em>out</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Each derived class should support some routine to report on the file. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>out</em>&nbsp;</td><td>Reference to the ostream to write the report </td></tr>
  </table>
</dl>

<p>
Implements <a class="el" href="classASCbase_1_1CoordFile.html#a2153c9f750dd76c3b533f9e03bd8f05">ASCbase::CoordFile</a>.
</div>
</div><p>
<a class="anchor" name="050d5348e9f9a59de0949a66acab96de"></a><!-- doxytag: member="ASCbase::mol2File::write" ref="050d5348e9f9a59de0949a66acab96de" args="(std::string ofname)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool mol2File::write           </td>
          <td>(</td>
          <td class="paramtype">std::string&nbsp;</td>
          <td class="paramname"> <em>ofname</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Write the molecule(s) to the specified file. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>ofname</em>&nbsp;</td><td>Name of the file to write molecule(s) </td></tr>
  </table>
</dl>

<p>
Implements <a class="el" href="classASCbase_1_1CoordFile.html#dca3f5f45c21f85215dc380e2152b613">ASCbase::CoordFile</a>.
</div>
</div><p>
<hr>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="mol2File_8H-source.html">mol2File.H</a><li>mol2File.C</ul>
<hr size="1"><address style="align: right;"><small>Generated on Tue Apr 3 23:09:20 2012 for simsite3d by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.4.7 </small></address>
</body>
</html>
