\section{ASCbase::Prot\-Lig\-Score Class Reference}
\label{classASCbase_1_1ProtLigScore}\index{ASCbase::ProtLigScore@{ASCbase::ProtLigScore}}
{\tt \#include $<$Prot\-Lig\-Score.H$>$}

\subsection*{Public Types}
\begin{CompactItemize}
\item 
typedef std::pair$<$ atom\_\-vci, atom\_\-act\_\-class\_\-t $>$ \textbf{atom\_\-act\_\-pair}\label{classASCbase_1_1ProtLigScore_27d6d786f7b39152b361b23dd9d5bbbb}

\item 
typedef std::map$<$ atom\_\-vci, atom\_\-act\_\-class\_\-t $>$ \textbf{atom\_\-act\_\-map}\label{classASCbase_1_1ProtLigScore_ce33f05b2e4c44c586465cf372a608ec}

\item 
typedef atom\_\-act\_\-map::iterator \textbf{atom\_\-act\_\-mi}\label{classASCbase_1_1ProtLigScore_919ad4c17215dc1ca9072def5d1f6f80}

\item 
typedef atom\_\-act\_\-map::const\_\-iterator \textbf{atom\_\-act\_\-mci}\label{classASCbase_1_1ProtLigScore_bdea38e65c716d29e71ed2e4521eb36b}

\item 
\textbf{INITIAL} = 0\label{classASCbase_1_1ProtLigScore_38da0bbb70c6f5a88b37e99939fa72117efb63b928321c54411b880623ea0fb6}

\item 
\textbf{INTERFACIAL\_\-ATOM}\label{classASCbase_1_1ProtLigScore_38da0bbb70c6f5a88b37e99939fa7211500e8743a0b378fddf0d53d673a40b47}

\item 
\textbf{METAL\_\-DIRECT\_\-HBOND}\label{classASCbase_1_1ProtLigScore_38da0bbb70c6f5a88b37e99939fa7211e93fbf76a21bb4ea027750f686e0fece}

\item 
\textbf{SALT\_\-BRIDGE}\label{classASCbase_1_1ProtLigScore_38da0bbb70c6f5a88b37e99939fa72112a51642889c858139d7b520652703b81}

\item 
\textbf{DIRECT\_\-HBOND}\label{classASCbase_1_1ProtLigScore_38da0bbb70c6f5a88b37e99939fa7211803e8fc1cf125b935a73b960416972aa}

\item 
\textbf{UNSAT\_\-CHARGE}\label{classASCbase_1_1ProtLigScore_38da0bbb70c6f5a88b37e99939fa72113a2e21f3f5eb470e89630ace57fca557}

\item 
\textbf{UNSAT\_\-POLAR}\label{classASCbase_1_1ProtLigScore_38da0bbb70c6f5a88b37e99939fa721193ca1d17e498b2126dd19ebeb0f93abf}

\item 
\textbf{INTRA\_\-LIGAND\_\-HBOND}\label{classASCbase_1_1ProtLigScore_38da0bbb70c6f5a88b37e99939fa721131df05afc5bf7240b89d5a0b09b0404b}

\item 
\textbf{INTRA\_\-LIGAND\_\-SALT\_\-BRIDGE}\label{classASCbase_1_1ProtLigScore_38da0bbb70c6f5a88b37e99939fa72119f36f771a2f0c2060396f693a09097aa}

\item 
\textbf{INTRA\_\-TARGET\_\-HBOND}\label{classASCbase_1_1ProtLigScore_38da0bbb70c6f5a88b37e99939fa7211465a604ea7061692e2e210b6b5d50a72}

\item 
\textbf{INTRA\_\-TARGET\_\-SALT\_\-BRIDGE}\label{classASCbase_1_1ProtLigScore_38da0bbb70c6f5a88b37e99939fa7211a154b072dd519a883d0b7b9b5c3b1055}

\item 
enum \textbf{atom\_\-act\_\-class\_\-t} \{ \par
\textbf{INITIAL} =  0, 
\textbf{INTERFACIAL\_\-ATOM}, 
\textbf{METAL\_\-DIRECT\_\-HBOND}, 
\textbf{SALT\_\-BRIDGE}, 
\par
\textbf{DIRECT\_\-HBOND}, 
\textbf{UNSAT\_\-CHARGE}, 
\textbf{UNSAT\_\-POLAR}, 
\textbf{INTRA\_\-LIGAND\_\-HBOND}, 
\par
\textbf{INTRA\_\-LIGAND\_\-SALT\_\-BRIDGE}, 
\textbf{INTRA\_\-TARGET\_\-HBOND}, 
\textbf{INTRA\_\-TARGET\_\-SALT\_\-BRIDGE}
 \}
\end{CompactItemize}
\subsection*{Public Member Functions}
\begin{CompactItemize}
\item 
\textbf{Prot\-Lig\-Score} (\bf{PDBStructure} \&prot, \bf{mol2File} \&lig, bool save\_\-prot\_\-lig\_\-acts=true, bool compute\_\-charge\_\-sums=true)\label{classASCbase_1_1ProtLigScore_1770dc58245d85131f7040e5acffdeff}

\item 
const my\_\-float\_\-t \textbf{affiscore} () const \label{classASCbase_1_1ProtLigScore_3b141a7e5ba3c877356e268809133520}

\item 
const my\_\-float\_\-t \textbf{orientscore} () const \label{classASCbase_1_1ProtLigScore_5d08bfc7c970cb20a8418452c70f676e}

\item 
const my\_\-float\_\-t \textbf{ligand\_\-efficiency} () const \label{classASCbase_1_1ProtLigScore_1f92dc0a2b0830b392f6f5648e6e316b}

\item 
void \textbf{print\_\-hbonds} (std::ostream \&out)\label{classASCbase_1_1ProtLigScore_2632d23a6e61c4c16781bf8fe9323fda}

\item 
void \textbf{classic\_\-report} (std::ostream \&out)\label{classASCbase_1_1ProtLigScore_60120a05bc1c6cd704174e08e3110ba1}

\item 
void \textbf{report\_\-scores} (std::ostream \&out, char delim= '$|$')\label{classASCbase_1_1ProtLigScore_908635d9e01981a9e813df7947505f3d}

\item 
void \bf{gen\_\-lig\_\-act\_\-strings} (const char field\_\-delim= '$|$', const char prot\_\-delim= ',')
\begin{CompactList}\small\item\em Generate the ligand atoms' interaction strings. \item\end{CompactList}\item 
void \bf{write\_\-lig\_\-acts} (std::ostream \&out=std::cout, char field\_\-delim= '$|$', char prot\_\-delim= ',')\label{classASCbase_1_1ProtLigScore_1433bfcfed24d1a064ad4ead1f5e6a47}

\begin{CompactList}\small\item\em Write the ligand atoms with corresponding interactions from the protein. \item\end{CompactList}\item 
std::vector$<$ salt\_\-bridge\_\-t $>$::const\_\-iterator \textbf{salt\_\-bridges\_\-begin} () const \label{classASCbase_1_1ProtLigScore_91e6b0e118597d22d6a7cd4deecc45da}

\item 
std::vector$<$ salt\_\-bridge\_\-t $>$::const\_\-iterator \textbf{salt\_\-bridges\_\-end} () const \label{classASCbase_1_1ProtLigScore_ea289b8b558b201953876c8e9ed0f4a3}

\item 
std::vector$<$ hbond\_\-t $>$::const\_\-iterator \textbf{hbonds\_\-begin} () const \label{classASCbase_1_1ProtLigScore_52476c5b5fdeb1e03c06f92ab6be71e0}

\item 
std::vector$<$ hbond\_\-t $>$::const\_\-iterator \textbf{hbonds\_\-end} () const \label{classASCbase_1_1ProtLigScore_9c33162446d3ba3d1788878ffea98039}

\item 
std::map$<$ residue\_\-vci, bool $>$::const\_\-iterator \textbf{hphob\_\-SC\_\-begin} () const \label{classASCbase_1_1ProtLigScore_78531873dda937cd13058da1898dc9b9}

\item 
std::map$<$ residue\_\-vci, bool $>$::const\_\-iterator \textbf{hphob\_\-SC\_\-end} () const \label{classASCbase_1_1ProtLigScore_2450c044ac7c187dd0cf1a74fd3f15ad}

\item 
const std::string \textbf{lig\_\-name} () const \label{classASCbase_1_1ProtLigScore_c17dbe0c860a1d3f6b43c6e82eade318}

\item 
std::vector$<$ std::string $>$::const\_\-iterator \bf{lig\_\-act\_\-strings\_\-begin} ()
\item 
std::vector$<$ std::string $>$::const\_\-iterator \bf{lig\_\-act\_\-strings\_\-end} ()
\end{CompactItemize}
\subsection*{Static Public Member Functions}
\begin{CompactItemize}
\item 
static void \textbf{score\_\-header\_\-lines} (std::ostream \&out, bool classic=false)\label{classASCbase_1_1ProtLigScore_dc5ffb2f1b082529473e3ee6f2843ba8}

\end{CompactItemize}
\subsection*{Private Member Functions}
\begin{CompactItemize}
\item 
void \textbf{compute\_\-scores} ()\label{classASCbase_1_1ProtLigScore_020f3f7d5ed48200fee48009a7bd0981}

\item 
void \textbf{compute\_\-terms} ()\label{classASCbase_1_1ProtLigScore_3273df40e4af4de8771f42a171ff49b9}

\item 
void \textbf{metal\_\-interactions} (atom\_\-vci lig\_\-atom, int $\ast$num\_\-lig\_\-nbrs)\label{classASCbase_1_1ProtLigScore_43197dcbdb8db5e8134c4536593a1554}

\item 
void \textbf{prot\_\-lig\_\-atom\_\-interactions} (atom\_\-vci lig\_\-atom, int $\ast$num\_\-lig\_\-nbrs, int $\ast$sum\_\-hphob\_\-hphob, int $\ast$num\_\-hphob\_\-hphob\_\-contact\_\-1\_\-lig\_\-atm)\label{classASCbase_1_1ProtLigScore_35a77eb830e6ea30f0f7e0974337e507}

\item 
void \textbf{polar\_\-interaction} (atom\_\-vci prot\_\-atom, atom\_\-vci lig\_\-atom, my\_\-float\_\-t sq\_\-dist)\label{classASCbase_1_1ProtLigScore_f0ffc28a9f7912538c6a50ddbd892af3}

\item 
void \textbf{flag\_\-intra\_\-ligand\_\-hbonds} ()\label{classASCbase_1_1ProtLigScore_52feb68979289cc9695aaf867c54694e}

\item 
void \textbf{flag\_\-intra\_\-protein\_\-hbonds} ()\label{classASCbase_1_1ProtLigScore_9bf29dd817db457447811f73f49e3dff}

\item 
void \textbf{sum\_\-target\_\-hydrophobicity} ()\label{classASCbase_1_1ProtLigScore_15510c6a4dd67ed6855d344a4ea26806}

\item 
void \textbf{flag\_\-unsat\_\-polar\_\-atoms} (atom\_\-act\_\-map $\ast$my\_\-map, int $\ast$num\_\-unsat\_\-charge, int $\ast$num\_\-unsat\_\-polar)\label{classASCbase_1_1ProtLigScore_d98d4a8ed3743a00db0f83efe90d0f1e}

\item 
void \textbf{print\_\-atom\_\-act\_\-classes} (atom\_\-act\_\-map $\ast$my\_\-map)\label{classASCbase_1_1ProtLigScore_b56c70e1c49a08b5b8bd3b52b508b43d}

\end{CompactItemize}
\subsection*{Private Attributes}
\begin{CompactItemize}
\item 
\bf{PDBStructure} $\ast$ \bf{A\_\-prot}\label{classASCbase_1_1ProtLigScore_5b1a480b3bf5f9c011497ba534fa9461}

\begin{CompactList}\small\item\em Pointer to target protein data structures -- only valid while constructor is active. \item\end{CompactList}\item 
\bf{mol2File} $\ast$ \bf{A\_\-lig}\label{classASCbase_1_1ProtLigScore_dfbf1284c9cbed4b54206df9fdddef28}

\begin{CompactList}\small\item\em Pointer to ligand to score -- only valid while constructor is active. \item\end{CompactList}\item 
\bf{Hbond\-Geometry} \bf{A\_\-hbond\_\-geometry}\label{classASCbase_1_1ProtLigScore_6671697549e83639b589b71488f550d9}

\begin{CompactList}\small\item\em Instance of hbond geometry class. \item\end{CompactList}\item 
std::map$<$ atom\_\-vci, atom\_\-act\_\-class\_\-t $>$ \textbf{A\_\-ligand\_\-flag}\label{classASCbase_1_1ProtLigScore_8b4747bab4ae82a169058b0aef3a2f42}

\item 
std::map$<$ atom\_\-vci, atom\_\-act\_\-class\_\-t $>$ \textbf{A\_\-target\_\-flag}\label{classASCbase_1_1ProtLigScore_8f73fb747d5bf69e796cccad62f2926b}

\item 
std::vector$<$ salt\_\-bridge\_\-t $>$ \bf{A\_\-prot\_\-lig\_\-SB}\label{classASCbase_1_1ProtLigScore_0d045558a8b159755a49bfa691ea3977}

\begin{CompactList}\small\item\em Protein-ligand salt bridges. \item\end{CompactList}\item 
std::vector$<$ hbond\_\-t $>$ \bf{A\_\-prot\_\-lig\_\-hbonds}\label{classASCbase_1_1ProtLigScore_3cbb26774378dac3641e3060cc3bca30}

\begin{CompactList}\small\item\em Protein-ligand hbonds. \item\end{CompactList}\item 
std::map$<$ residue\_\-vci, bool $>$ \bf{A\_\-hphob\_\-prot\_\-SC}\label{classASCbase_1_1ProtLigScore_d821097b1cb76b5bcc2e784d923c64f1}

\begin{CompactList}\small\item\em Keep note of hphob sidechains interating with ligand hphob atoms. \item\end{CompactList}\item 
raw\_\-terms\_\-type \textbf{A\_\-raw\_\-terms}\label{classASCbase_1_1ProtLigScore_6057aed97ad9d2f821e0243d0e991824}

\item 
int \bf{A\_\-num\_\-lig\_\-carbons}\label{classASCbase_1_1ProtLigScore_e8f1ebf48410e8bfa049bf7dad668351}

\begin{CompactList}\small\item\em Count of carbons in the ligand. \item\end{CompactList}\item 
int \bf{A\_\-num\_\-exposed\_\-lig\_\-carbons}\label{classASCbase_1_1ProtLigScore_6886d65b0975f0c237500478ba4a198c}

\begin{CompactList}\small\item\em Count of ligand carbon atoms with no protein neighbors (within 4.5 (A)). \item\end{CompactList}\item 
std::vector$<$ my\_\-float\_\-t $>$ \textbf{A\_\-affi\_\-terms}\label{classASCbase_1_1ProtLigScore_73c73cd82b0d7bfff4838314cd84ab0b}

\item 
my\_\-float\_\-t \textbf{A\_\-affiscore}\label{classASCbase_1_1ProtLigScore_7e1e577116eee25a76c19f55682c1558}

\item 
my\_\-float\_\-t \textbf{A\_\-orientscore}\label{classASCbase_1_1ProtLigScore_5535061a8d607e195cfc72d8836e5302}

\item 
my\_\-float\_\-t \textbf{A\_\-affiefficientscore}\label{classASCbase_1_1ProtLigScore_49bb696b0e08da39348198573860b0d7}

\item 
bool \textbf{A\_\-keep\_\-prot\_\-lig\_\-acts}\label{classASCbase_1_1ProtLigScore_bbc85c49bf05b6d54a1f786596f47b1f}

\item 
std::vector$<$ std::vector$<$ residue\_\-vci $>$ $>$ \textbf{A\_\-hphob\_\-prot\_\-lig\_\-SC}\label{classASCbase_1_1ProtLigScore_f737fa004d7fa88be1f6f9c6d155b099}

\item 
std::vector$<$ bool $>$ \textbf{A\_\-lig\_\-exposed\_\-Cz}\label{classASCbase_1_1ProtLigScore_c449cc6743b06bef1df97a236a693305}

\item 
std::vector$<$ std::string $>$ \bf{A\_\-lig\_\-act\_\-strings}\label{classASCbase_1_1ProtLigScore_615545947d1470e69c9aa7b0169b4b28}

\begin{CompactList}\small\item\em A string for each ligand atom that denoting interactions with the protein. \item\end{CompactList}\end{CompactItemize}
\subsection*{Static Private Attributes}
\begin{CompactItemize}
\item 
static const my\_\-float\_\-t \textbf{MIN\_\-BURY\_\-SQUARED\_\-DIST} = 1.9 $\ast$ 1.9\label{classASCbase_1_1ProtLigScore_f5458d92783fb455d0a7b474734862ac}

\item 
static const my\_\-float\_\-t \textbf{MAX\_\-BURY\_\-SQUARED\_\-DIST} = 4.5 $\ast$ 4.5\label{classASCbase_1_1ProtLigScore_8351bdb8162c375a142cc69d4125661a}

\item 
static const my\_\-float\_\-t \textbf{HYDRO\_\-SQUARED\_\-DIST} = 4.5 $\ast$ 4.5\label{classASCbase_1_1ProtLigScore_9629a637153e69bc93198e76bd054ff8}

\item 
static const my\_\-float\_\-t \textbf{MAX\_\-INTERACT\_\-SQUARED\_\-DIST} = 4.5 $\ast$ 4.5\label{classASCbase_1_1ProtLigScore_38fd929f2c9ae78cc55b55383e910fa4}

\item 
static const my\_\-float\_\-t \textbf{AFFI\_\-64\_\-WEIGHTS} [$\,$]
\item 
static const my\_\-float\_\-t \textbf{ORIENT\_\-99\_\-WEIGHTS} [$\,$]
\end{CompactItemize}
\subsection*{Classes}
\begin{CompactItemize}
\item 
struct \textbf{hbond\_\-t}
\item 
struct \textbf{raw\_\-terms\_\-type}
\item 
struct \textbf{salt\_\-bridge\_\-t}
\end{CompactItemize}


\subsection{Detailed Description}
Compute orientation and affinity scores between protein atoms and ligand atoms. Note: because the protein and ligand are required for scoring but also used by other functions, this class is really only valid if both the ligand and protein objects are still in scope (exist). 



\subsection{Member Function Documentation}
\index{ASCbase::ProtLigScore@{ASCbase::Prot\-Lig\-Score}!gen_lig_act_strings@{gen\_\-lig\_\-act\_\-strings}}
\index{gen_lig_act_strings@{gen\_\-lig\_\-act\_\-strings}!ASCbase::ProtLigScore@{ASCbase::Prot\-Lig\-Score}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}void Prot\-Lig\-Score::gen\_\-lig\_\-act\_\-strings (const char {\em field\_\-delim} = {\tt '$|$'}, const char {\em prot\_\-delim} = {\tt ','})}\label{classASCbase_1_1ProtLigScore_f89729aba4e721e341a91e795438a129}


Generate the ligand atoms' interaction strings. 

This function is public to support the ASCbase\-Py interface \index{ASCbase::ProtLigScore@{ASCbase::Prot\-Lig\-Score}!lig_act_strings_begin@{lig\_\-act\_\-strings\_\-begin}}
\index{lig_act_strings_begin@{lig\_\-act\_\-strings\_\-begin}!ASCbase::ProtLigScore@{ASCbase::Prot\-Lig\-Score}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}std::vector$<$std::string$>$::const\_\-iterator ASCbase::Prot\-Lig\-Score::lig\_\-act\_\-strings\_\-begin ()\hspace{0.3cm}{\tt  [inline]}}\label{classASCbase_1_1ProtLigScore_8b4e7de39e5853938e31039394322b4f}


Added for ASCbase\-Py interface -- why compute it in python when it is already computed and debugged in C++ \index{ASCbase::ProtLigScore@{ASCbase::Prot\-Lig\-Score}!lig_act_strings_end@{lig\_\-act\_\-strings\_\-end}}
\index{lig_act_strings_end@{lig\_\-act\_\-strings\_\-end}!ASCbase::ProtLigScore@{ASCbase::Prot\-Lig\-Score}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}std::vector$<$std::string$>$::const\_\-iterator ASCbase::Prot\-Lig\-Score::lig\_\-act\_\-strings\_\-end ()\hspace{0.3cm}{\tt  [inline]}}\label{classASCbase_1_1ProtLigScore_934c0d6ca9955e06c2548020e415a1e9}


Added for ASCbase\-Py interface -- why compute it in python when it is already computed and debugged in C++ 

\subsection{Member Data Documentation}
\index{ASCbase::ProtLigScore@{ASCbase::Prot\-Lig\-Score}!AFFI_64_WEIGHTS@{AFFI\_\-64\_\-WEIGHTS}}
\index{AFFI_64_WEIGHTS@{AFFI\_\-64\_\-WEIGHTS}!ASCbase::ProtLigScore@{ASCbase::Prot\-Lig\-Score}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}const my\_\-float\_\-t Prot\-Lig\-Score::AFFI\_\-64\_\-WEIGHTS\hspace{0.3cm}{\tt  [static, private]}}\label{classASCbase_1_1ProtLigScore_fed52d2f3a0f38d69cb8cfd172a0798e}


\textbf{Initial value:}

\begin{Code}\begin{verbatim} 
  {-5.218,-0.239,-0.083, 0.134,0.000,0.000,0.000 }
\end{verbatim}\end{Code}
\index{ASCbase::ProtLigScore@{ASCbase::Prot\-Lig\-Score}!ORIENT_99_WEIGHTS@{ORIENT\_\-99\_\-WEIGHTS}}
\index{ORIENT_99_WEIGHTS@{ORIENT\_\-99\_\-WEIGHTS}!ASCbase::ProtLigScore@{ASCbase::Prot\-Lig\-Score}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}const my\_\-float\_\-t Prot\-Lig\-Score::ORIENT\_\-99\_\-WEIGHTS\hspace{0.3cm}{\tt  [static, private]}}\label{classASCbase_1_1ProtLigScore_d03935e16ddc38eacaaad7939c38c030}


\textbf{Initial value:}

\begin{Code}\begin{verbatim} 
  {-3.917,-0.061,-0.023,-0.189,0.000,0.000,0.000 }
\end{verbatim}\end{Code}


The documentation for this class was generated from the following files:\begin{CompactItemize}
\item 
Prot\-Lig\-Score.H\item 
Prot\-Lig\-Score.C\end{CompactItemize}
