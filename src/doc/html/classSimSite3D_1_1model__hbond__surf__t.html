<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>simsite3d: ASCbase::model_hbond_surf_t Class Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.4.7 -->
<div class="tabs">
  <ul>
    <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
    <li id="current"><a href="annotated.html"><span>Classes</span></a></li>
    <li><a href="files.html"><span>Files</span></a></li>
  </ul></div>
<div class="tabs">
  <ul>
    <li><a href="annotated.html"><span>Class&nbsp;List</span></a></li>
    <li><a href="hierarchy.html"><span>Class&nbsp;Hierarchy</span></a></li>
    <li><a href="functions.html"><span>Class&nbsp;Members</span></a></li>
  </ul></div>
<div class="nav">
<b>ASCbase</b>::<a class="el" href="classASCbase_1_1model__hbond__surf__t.html">model_hbond_surf_t</a></div>
<h1>ASCbase::model_hbond_surf_t Class Reference</h1><!-- doxytag: class="ASCbase::model_hbond_surf_t" --><!-- doxytag: inherits="ASCbase::hbond_surface_t" --><code>#include &lt;<a class="el" href="ModelHbondSurfaces_8H-source.html">ModelHbondSurfaces.H</a>&gt;</code>
<p>
<p>Inheritance diagram for ASCbase::model_hbond_surf_t:
<p><center><img src="classASCbase_1_1model__hbond__surf__t.png" usemap="#ASCbase::model_hbond_surf_t_map" border="0" alt=""></center>
<map name="ASCbase::model_hbond_surf_t_map">
<area href="classASCbase_1_1hbond__surface__t.html" alt="ASCbase::hbond_surface_t" shape="rect" coords="0,168,191,192">
<area href="classASCbase_1_1hbond__ideal__pt__base.html" alt="ASCbase::hbond_ideal_pt_base" shape="rect" coords="0,112,191,136">
<area href="classASCbase_1_1dir__point__t.html" alt="ASCbase::dir_point_t" shape="rect" coords="0,56,191,80">
<area href="classASCbase_1_1point__t.html" alt="ASCbase::point_t" shape="rect" coords="0,0,191,24">
</map>
<a href="classASCbase_1_1model__hbond__surf__t-members.html">List of all members.</a><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="cb646a3dbc03f4990450144a918753a8"></a><!-- doxytag: member="ASCbase::model_hbond_surf_t::model_hbond_surf_t" ref="cb646a3dbc03f4990450144a918753a8" args="(const std::string &amp;data_line, PDBBase &amp;prot_atoms, const uint level=2)" -->
&nbsp;</td><td class="memItemRight" valign="bottom"><b>model_hbond_surf_t</b> (const std::string &amp;data_line, <a class="el" href="classASCbase_1_1PDBBase.html">PDBBase</a> &amp;prot_atoms, const uint level=2)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="c6978b9984df3bdd11e5b492600468c2"></a><!-- doxytag: member="ASCbase::model_hbond_surf_t::model_hbond_surf_t" ref="c6978b9984df3bdd11e5b492600468c2" args="(const model_hbond_surf_t &amp;src)" -->
&nbsp;</td><td class="memItemRight" valign="bottom"><b>model_hbond_surf_t</b> (const <a class="el" href="classASCbase_1_1model__hbond__surf__t.html">model_hbond_surf_t</a> &amp;src)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="01930d6fccfbfb3c509b686060699606"></a><!-- doxytag: member="ASCbase::model_hbond_surf_t::operator=" ref="01930d6fccfbfb3c509b686060699606" args="(const model_hbond_surf_t &amp;src)" -->
<a class="el" href="classASCbase_1_1model__hbond__surf__t.html">model_hbond_surf_t</a> &amp;&nbsp;</td><td class="memItemRight" valign="bottom"><b>operator=</b> (const <a class="el" href="classASCbase_1_1model__hbond__surf__t.html">model_hbond_surf_t</a> &amp;src)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="65d5a73c0ffcbada1c8496c81a43929a"></a><!-- doxytag: member="ASCbase::model_hbond_surf_t::transform" ref="65d5a73c0ffcbada1c8496c81a43929a" args="(const my_float_t *R, const my_float_t *T)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><b>transform</b> (const my_float_t *R, const my_float_t *T)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="b0ebe991b54fb1b3247a4a716a0673d4"></a><!-- doxytag: member="ASCbase::model_hbond_surf_t::inverse_transform" ref="b0ebe991b54fb1b3247a4a716a0673d4" args="(const my_float_t *R, const my_float_t *T)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><b>inverse_transform</b> (const my_float_t *R, const my_float_t *T)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="da904de58db5258030d9144908f915c6"></a><!-- doxytag: member="ASCbase::model_hbond_surf_t::revert" ref="da904de58db5258030d9144908f915c6" args="()" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><b>revert</b> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classASCbase_1_1model__hbond__surf__t.html#a8ae4c19a792214f114129077475df01">compute_best_terms</a> (std::vector&lt; <a class="el" href="classASCbase_1_1hbond__surface__t.html">hbond_surface_t</a> &gt;::iterator surfs_begin, std::vector&lt; <a class="el" href="classASCbase_1_1hbond__surface__t.html">hbond_surface_t</a> &gt;::iterator surfs_end, my_float_t *AA_DD_terms, my_float_t *doneptor_terms, my_float_t *surface_area, const my_float_t dist_tol=1.0) const </td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Compute the best terms for each vertex in the model surface.  <a href="#a8ae4c19a792214f114129077475df01"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="d29013b948a3de1594b72640d8f54aa0"></a><!-- doxytag: member="ASCbase::model_hbond_surf_t::num_terms" ref="d29013b948a3de1594b72640d8f54aa0" args="() const " -->
const uint&nbsp;</td><td class="memItemRight" valign="bottom"><b>num_terms</b> () const </td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="7a0344de6eb971227cf37c96b0b11606"></a><!-- doxytag: member="ASCbase::model_hbond_surf_t::num_verts" ref="7a0344de6eb971227cf37c96b0b11606" args="() const " -->
const uint&nbsp;</td><td class="memItemRight" valign="bottom"><b>num_verts</b> () const </td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="fad5a5374d17a84192f1f8fc74ea8876"></a><!-- doxytag: member="ASCbase::model_hbond_surf_t::verts_begin" ref="fad5a5374d17a84192f1f8fc74ea8876" args="() const " -->
const geometry::vertex_vci&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classASCbase_1_1model__hbond__surf__t.html#fad5a5374d17a84192f1f8fc74ea8876">verts_begin</a> () const </td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get a constant iterator to the first vertex in the vector. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="50ec409886843895685f8549707ba15e"></a><!-- doxytag: member="ASCbase::model_hbond_surf_t::verts_end" ref="50ec409886843895685f8549707ba15e" args="() const " -->
const geometry::vertex_vci&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classASCbase_1_1model__hbond__surf__t.html#50ec409886843895685f8549707ba15e">verts_end</a> () const </td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get a constant iterator to the end of the vertex vector. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="d97fb2ca02976980a4c1e78b46b0df63"></a><!-- doxytag: member="ASCbase::model_hbond_surf_t::closest_pts_begin" ref="d97fb2ca02976980a4c1e78b46b0df63" args="() const " -->
const my_float_t *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classASCbase_1_1model__hbond__surf__t.html#d97fb2ca02976980a4c1e78b46b0df63">closest_pts_begin</a> () const </td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get a constant pointer to the first point in the closest points array. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="dd599b65e329040ffdaea701a3acbaeb"></a><!-- doxytag: member="ASCbase::model_hbond_surf_t::closest_pts_end" ref="dd599b65e329040ffdaea701a3acbaeb" args="() const " -->
const my_float_t *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classASCbase_1_1model__hbond__surf__t.html#dd599b65e329040ffdaea701a3acbaeb">closest_pts_end</a> () const </td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get a constant pointer to the end of the closest points array. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="05e5c2efb6bd80474c20a983c10324ff"></a><!-- doxytag: member="ASCbase::model_hbond_surf_t::closest_pts_dists_begin" ref="05e5c2efb6bd80474c20a983c10324ff" args="() const " -->
const my_float_t *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classASCbase_1_1model__hbond__surf__t.html#05e5c2efb6bd80474c20a983c10324ff">closest_pts_dists_begin</a> () const </td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get a constant pointer to the first distance in the distances array. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="a0183e08be99f865caa5c59f0441529f"></a><!-- doxytag: member="ASCbase::model_hbond_surf_t::closest_pts_dists_end" ref="a0183e08be99f865caa5c59f0441529f" args="() const " -->
const my_float_t *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classASCbase_1_1model__hbond__surf__t.html#a0183e08be99f865caa5c59f0441529f">closest_pts_dists_end</a> () const </td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get a constant pointer to the end of the distances array. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="2c3b46d219e290bd39bf60cdc9210fcc"></a><!-- doxytag: member="ASCbase::model_hbond_surf_t::write" ref="2c3b46d219e290bd39bf60cdc9210fcc" args="(std::ostream &amp;out, const interactionType point_type, const char delim='|') const " -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><b>write</b> (std::ostream &amp;out, const interactionType point_type, const char delim='|') const </td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="ac5245563487a78bec4f41d973dae1ef"></a><!-- doxytag: member="ASCbase::model_hbond_surf_t::write_msms_headers" ref="ac5245563487a78bec4f41d973dae1ef" args="(std::ostream &amp;vert_out, std::ostream &amp;face_out) const " -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><b>write_msms_headers</b> (std::ostream &amp;vert_out, std::ostream &amp;face_out) const </td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="b7a5a82b5ba33c13c2f1fde5e2c68e93"></a><!-- doxytag: member="ASCbase::model_hbond_surf_t::write_msms_cap" ref="b7a5a82b5ba33c13c2f1fde5e2c68e93" args="(std::ostream &amp;vert_out, std::ostream &amp;face_out) const " -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><b>write_msms_cap</b> (std::ostream &amp;vert_out, std::ostream &amp;face_out) const </td></tr>

<tr><td colspan="2"><br><h2>Private Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="258b7159aac2ffbbe568db054127092f"></a><!-- doxytag: member="ASCbase::model_hbond_surf_t::adjust_terms" ref="258b7159aac2ffbbe568db054127092f" args="(const my_float_t dot_prod, const my_float_t distance, const my_float_t dist_tol, my_float_t *row) const " -->
bool&nbsp;</td><td class="memItemRight" valign="bottom"><b>adjust_terms</b> (const my_float_t dot_prod, const my_float_t distance, const my_float_t dist_tol, my_float_t *row) const </td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="695c87b6533ec81d5780c82fff1a6aed"></a><!-- doxytag: member="ASCbase::model_hbond_surf_t::do_copy" ref="695c87b6533ec81d5780c82fff1a6aed" args="(const model_hbond_surf_t &amp;src)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><b>do_copy</b> (const <a class="el" href="classASCbase_1_1model__hbond__surf__t.html">model_hbond_surf_t</a> &amp;src)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="864c86053b4b227a58f820bb73d46064"></a><!-- doxytag: member="ASCbase::model_hbond_surf_t::init" ref="864c86053b4b227a58f820bb73d46064" args="()" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><b>init</b> ()</td></tr>

<tr><td colspan="2"><br><h2>Private Attributes</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="64c41345670808e5f52e8b01661330e3"></a><!-- doxytag: member="ASCbase::model_hbond_surf_t::A_mesh_surf" ref="64c41345670808e5f52e8b01661330e3" args="" -->
<a class="el" href="classASCbase_1_1geometry_1_1TriMeshSphere.html">geometry::TriMeshSphere</a>&nbsp;</td><td class="memItemRight" valign="bottom"><b>A_mesh_surf</b></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="9146d87c587720dc5f4b1a26061e68e7"></a><!-- doxytag: member="ASCbase::model_hbond_surf_t::A_closest_pts" ref="9146d87c587720dc5f4b1a26061e68e7" args="" -->
my_float_t *&nbsp;</td><td class="memItemRight" valign="bottom"><b>A_closest_pts</b></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="fe16dd162d555d9c018561573a463aaf"></a><!-- doxytag: member="ASCbase::model_hbond_surf_t::A_dists" ref="fe16dd162d555d9c018561573a463aaf" args="" -->
my_float_t *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classASCbase_1_1model__hbond__surf__t.html#fe16dd162d555d9c018561573a463aaf">A_dists</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Current closest point for each cap point. <br></td></tr>
<tr><td colspan="2"><br><h2>Static Private Attributes</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="7e554d42744ddf3ab7903a73937e3aeb"></a><!-- doxytag: member="ASCbase::model_hbond_surf_t::A_num_terms" ref="7e554d42744ddf3ab7903a73937e3aeb" args="" -->
static const uint&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classASCbase_1_1model__hbond__surf__t.html#7e554d42744ddf3ab7903a73937e3aeb">A_num_terms</a> = 6</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Current distances for corresponding points. <br></td></tr>
</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
I am currently in a bind and to get this working quickly, I am abusing the format to handle metals as well. In the case of metals we do NOT have neighbor atom or an initial cap cutting plane (metals are modeled as not having a prefered direction). 
<p>
<hr><h2>Member Function Documentation</h2>
<a class="anchor" name="a8ae4c19a792214f114129077475df01"></a><!-- doxytag: member="ASCbase::model_hbond_surf_t::compute_best_terms" ref="a8ae4c19a792214f114129077475df01" args="(std::vector&lt; hbond_surface_t &gt;::iterator surfs_begin, std::vector&lt; hbond_surface_t &gt;::iterator surfs_end, my_float_t *AA_DD_terms, my_float_t *doneptor_terms, my_float_t *surface_area, const my_float_t dist_tol=1.0) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void model_hbond_surf_t::compute_best_terms           </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; <a class="el" href="classASCbase_1_1hbond__surface__t.html">hbond_surface_t</a> &gt;::iterator&nbsp;</td>
          <td class="paramname"> <em>surfs_begin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; <a class="el" href="classASCbase_1_1hbond__surface__t.html">hbond_surface_t</a> &gt;::iterator&nbsp;</td>
          <td class="paramname"> <em>surfs_end</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">my_float_t *&nbsp;</td>
          <td class="paramname"> <em>AA_DD_terms</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">my_float_t *&nbsp;</td>
          <td class="paramname"> <em>doneptor_terms</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">my_float_t *&nbsp;</td>
          <td class="paramname"> <em>surface_area</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const my_float_t&nbsp;</td>
          <td class="paramname"> <em>dist_tol</em> = <code>1.0</code></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"> const</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Compute the best terms for each vertex in the model surface. 
<p>
The features for each point are: <ol>
<li>
Positive value if point was matched </li>
<li>
Best dot product for pts within tolerace </li>
<li>
Linear weighting of closest point within tolerance </li>
<li>
Squared weighting of closest point within tolerance </li>
<li>
Dot product times linear weighting of closest point within tolerance </li>
<li>
Dot product times squared weighting of closest point within tolerance </li>
</ol>

</div>
</div><p>
<hr>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="ModelHbondSurfaces_8H-source.html">ModelHbondSurfaces.H</a><li>ModelHbondSurfaces.C</ul>
<hr size="1"><address style="align: right;"><small>Generated on Tue Apr 3 23:09:19 2012 for simsite3d by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.4.7 </small></address>
</body>
</html>
