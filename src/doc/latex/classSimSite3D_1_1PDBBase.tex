\section{SimSite3D::PDBBase Class Reference}
\label{classSimSite3D_1_1PDBBase}\index{SimSite3D::PDBBase@{SimSite3D::PDBBase}}
Base class for reading and writing PDB coordinate files.  


{\tt \#include $<$PDBBase.H$>$}

Inheritance diagram for SimSite3D::PDBBase::\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=3cm]{classSimSite3D_1_1PDBBase}
\end{center}
\end{figure}
\subsection*{Public Types}
\begin{CompactItemize}
\item 
typedef std::vector$<$ \bf{modres\_\-record\_\-type} $>$ \textbf{modres\_\-record\_\-vec}\label{classSimSite3D_1_1PDBBase_8d5d34b3f2916c01b64e7bc31036098b}

\item 
typedef modres\_\-record\_\-vec::iterator \textbf{modres\_\-record\_\-vi}\label{classSimSite3D_1_1PDBBase_350b2317b7319d666ec8e5f63d604f75}

\item 
typedef modres\_\-record\_\-vec::const\_\-iterator \textbf{modres\_\-record\_\-vci}\label{classSimSite3D_1_1PDBBase_c99c0ff276ac01a6424628da2c659872}

\item 
typedef std::vector$<$ \bf{het\_\-record\_\-type} $>$ \textbf{het\_\-record\_\-vec}\label{classSimSite3D_1_1PDBBase_61db0e7bba877dddbc56ffcfde427b23}

\item 
typedef het\_\-record\_\-vec::iterator \textbf{het\_\-record\_\-vi}\label{classSimSite3D_1_1PDBBase_04bbb2851e1d5cb94623b22c6290efe8}

\item 
typedef het\_\-record\_\-vec::const\_\-iterator \textbf{het\_\-record\_\-vci}\label{classSimSite3D_1_1PDBBase_da9851127724fcf51ca15403d73f3803}

\end{CompactItemize}
\subsection*{Public Member Functions}
\begin{CompactItemize}
\item 
\bf{PDBBase} ()\label{classSimSite3D_1_1PDBBase_b8a7226b098f891fff8a84c8efac0e94}

\begin{CompactList}\small\item\em Typically used to create a PDB file. \item\end{CompactList}\item 
\bf{PDBBase} (const std::string filename, const verbose\_\-level\_\-t verbosity=VERBOSE\_\-SILENT)
\begin{CompactList}\small\item\em Read in a PDB file. \item\end{CompactList}\item 
\bf{$\sim$PDBBase} ()\label{classSimSite3D_1_1PDBBase_d5a3b091d8d5a6e718a8ed91b2d3720d}

\begin{CompactList}\small\item\em Do nothing destructor. \item\end{CompactList}\item 
bool \bf{write} (const std::string filename)
\begin{CompactList}\small\item\em Write the atoms to file in PDB format. \item\end{CompactList}\item 
const bool \bf{const\_\-write} (const std::string filename) const \label{classSimSite3D_1_1PDBBase_3a17f60455b5bb35305dd7a4405930dd}

\begin{CompactList}\small\item\em entire existence is for debugging const pointers to pdb files \item\end{CompactList}\item 
bool \bf{write\_\-xyzr} (std::ostream \&out, bool include\_\-metals, const std::vector$<$ std::string $>$ \&waters)
\begin{CompactList}\small\item\em Write as xyzr lines (coordinates + radius). \item\end{CompactList}\item 
void \bf{set\_\-header} (const std::string h)
\begin{CompactList}\small\item\em Set the header. \item\end{CompactList}\item 
void \bf{report\_\-stats} (std::ostream \&out)\label{classSimSite3D_1_1PDBBase_7918cb94d1deb47d69fef5816e7a7782}

\begin{CompactList}\small\item\em does nothing \item\end{CompactList}\item 
modres\_\-record\_\-vci \textbf{modres\_\-records\_\-begin} () const \label{classSimSite3D_1_1PDBBase_011323485c71328e19088a1d63b7529c}

\item 
modres\_\-record\_\-vci \textbf{modres\_\-records\_\-end} () const \label{classSimSite3D_1_1PDBBase_9c75df999d4d3b5e2cf6ca398c9c37c0}

\item 
het\_\-record\_\-vci \textbf{het\_\-records\_\-begin} () const \label{classSimSite3D_1_1PDBBase_123db222cea71e537c127ead94792cd1}

\item 
het\_\-record\_\-vci \textbf{het\_\-records\_\-end} () const \label{classSimSite3D_1_1PDBBase_51ffbc4c560c201e959f162221bf9cd0}

\end{CompactItemize}
\subsection*{Static Public Member Functions}
\begin{CompactItemize}
\item 
static bool \bf{is\_\-hydrogen} (const std::string name)
\begin{CompactList}\small\item\em True if the pdb atom name is a hydrogen atom, else false. \item\end{CompactList}\item 
static pdb\_\-record\_\-type \bf{get\_\-record\_\-type} (const std::string line)
\end{CompactItemize}
\subsection*{Protected Member Functions}
\begin{CompactItemize}
\item 
bool \bf{read\_\-data} (std::ifstream \&fin)\label{classSimSite3D_1_1PDBBase_2c065e3bb88a3da81ba55ed4f02b3998}

\begin{CompactList}\small\item\em This is cheating, but .... I need a quick and dirty way to do this atm. \item\end{CompactList}\item 
bool \bf{read\_\-data} (std::ifstream \&fin, const bool ignore\_\-alt\-Locs)
\item 
void \bf{add\_\-het\_\-record} (atom\_\-vci atom)
\end{CompactItemize}
\subsection*{Private Member Functions}
\begin{CompactItemize}
\item 
bool \bf{get\_\-res\_\-info} (const std::string atom\_\-name, const std::string res\_\-name, \bf{atom\_\-t} $\ast$atom)
\item 
void \bf{read\_\-het\_\-record} (std::string \&het\_\-line)\label{classSimSite3D_1_1PDBBase_709ac8acd5d42fa1ffbb4b51c1251b03}

\begin{CompactList}\small\item\em Read a HET record and store it in the het record vector. \item\end{CompactList}\item 
void \bf{read\_\-modres\_\-record} (std::string \&modres\_\-line)\label{classSimSite3D_1_1PDBBase_b2935390dde55dd39526a43decee1eb7}

\begin{CompactList}\small\item\em Read a MODRES record and store it in the modres record vector. \item\end{CompactList}\end{CompactItemize}
\subsection*{Private Attributes}
\begin{CompactItemize}
\item 
het\_\-record\_\-vec \bf{A\_\-het\_\-records}\label{classSimSite3D_1_1PDBBase_611f815d363ce445712c8a0bf4facbb4}

\begin{CompactList}\small\item\em Vector of \char`\"{}HET   \char`\"{} records. \item\end{CompactList}\item 
modres\_\-record\_\-vec \bf{A\_\-modres\_\-records}\label{classSimSite3D_1_1PDBBase_6c966a768459840b7a19eacabd51d099}

\begin{CompactList}\small\item\em Vector of MODRES records. \item\end{CompactList}\item 
std::string \bf{A\_\-header}\label{classSimSite3D_1_1PDBBase_d97d60e884704fd46ee09111846b0989}

\begin{CompactList}\small\item\em String holding the header info. \item\end{CompactList}\end{CompactItemize}
\subsection*{Static Private Attributes}
\begin{CompactItemize}
\item 
static const std::string \bf{A\_\-fname} = \char`\"{}PDBBase.C\char`\"{}\label{classSimSite3D_1_1PDBBase_2abb2396c1c8ad545d6e463a8690043b}

\begin{CompactList}\small\item\em Name of source file. \item\end{CompactList}\end{CompactItemize}
\subsection*{Classes}
\begin{CompactItemize}
\item 
struct \bf{het\_\-record\_\-type}
\begin{CompactList}\small\item\em Holds the information in one HET record (line). \item\end{CompactList}\item 
struct \bf{modres\_\-record\_\-type}
\begin{CompactList}\small\item\em Holds the information in one MODRES record (line). \item\end{CompactList}\end{CompactItemize}


\subsection{Detailed Description}
Base class for reading and writing PDB coordinate files. 



\subsection{Constructor \& Destructor Documentation}
\index{SimSite3D::PDBBase@{SimSite3D::PDBBase}!PDBBase@{PDBBase}}
\index{PDBBase@{PDBBase}!SimSite3D::PDBBase@{SimSite3D::PDBBase}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}PDBBase::PDBBase (const std::string {\em filename}, const verbose\_\-level\_\-t {\em verbosity} = {\tt VERBOSE\_\-SILENT})}\label{classSimSite3D_1_1PDBBase_d4be3eb331549cbbe0cbed8c74e89817}


Read in a PDB file. 

After a successful call to this constructor, the heavy atoms will be accessible by the Coord\-File::begin()/end() functions.

\begin{Desc}
\item[Parameters:]
\begin{description}
\item[{\em filename}]Path to the PDB file to read (heavy atoms) \item[{\em verbosity}]Whether to send some comments to stdout or not \end{description}
\end{Desc}


\subsection{Member Function Documentation}
\index{SimSite3D::PDBBase@{SimSite3D::PDBBase}!add_het_record@{add\_\-het\_\-record}}
\index{add_het_record@{add\_\-het\_\-record}!SimSite3D::PDBBase@{SimSite3D::PDBBase}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}void PDBBase::add\_\-het\_\-record (atom\_\-vci {\em atom})\hspace{0.3cm}{\tt  [protected]}}\label{classSimSite3D_1_1PDBBase_e15bcd15e9d3d97f9b85f43a50557db7}


A number of pdb files do not have HET entries for 1 or more of the HET groups \index{SimSite3D::PDBBase@{SimSite3D::PDBBase}!get_record_type@{get\_\-record\_\-type}}
\index{get_record_type@{get\_\-record\_\-type}!SimSite3D::PDBBase@{SimSite3D::PDBBase}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}pdb\_\-record\_\-type PDBBase::get\_\-record\_\-type (const std::string {\em line})\hspace{0.3cm}{\tt  [static]}}\label{classSimSite3D_1_1PDBBase_9ca7950fae493f47aa2fedb86a797d50}


\begin{Desc}
\item[Parameters:]
\begin{description}
\item[{\em line}]PDB line to test \end{description}
\end{Desc}
\begin{Desc}
\item[Returns:]PDB atom line type (not atom line, hetatm, atom or hydrogen) \end{Desc}
\index{SimSite3D::PDBBase@{SimSite3D::PDBBase}!get_res_info@{get\_\-res\_\-info}}
\index{get_res_info@{get\_\-res\_\-info}!SimSite3D::PDBBase@{SimSite3D::PDBBase}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}bool PDBBase::get\_\-res\_\-info (const std::string {\em atom\_\-name}, const std::string {\em res\_\-name}, \bf{atom\_\-t} $\ast$ {\em atom})\hspace{0.3cm}{\tt  [private]}}\label{classSimSite3D_1_1PDBBase_2b49fed724fd6cc31ddd3eb804f7d89c}


Given an atom string an residue string, load the Van Der Waals radius, residue enum, atom enum and atom orbit into the given atom structure.

\begin{Desc}
\item[Parameters:]
\begin{description}
\item[{\em atom\_\-name}]4 char atom string \item[{\em res\_\-name}]3 char residue string \item[{\em atom}]Pointer to an atom structure return True if the given residue and atom strings are in table, else false \end{description}
\end{Desc}
\index{SimSite3D::PDBBase@{SimSite3D::PDBBase}!is_hydrogen@{is\_\-hydrogen}}
\index{is_hydrogen@{is\_\-hydrogen}!SimSite3D::PDBBase@{SimSite3D::PDBBase}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}bool PDBBase::is\_\-hydrogen (const std::string {\em name})\hspace{0.3cm}{\tt  [static]}}\label{classSimSite3D_1_1PDBBase_6ac23db47cc859ba574c999d40d52039}


True if the pdb atom name is a hydrogen atom, else false. 

Caution: you can't just test column 14 or you will remove metals like Rh, Cd, Pd, Nd, Gd, Md...

\begin{Desc}
\item[Parameters:]
\begin{description}
\item[{\em name}]The 4 columns used to specify the ATOM/HETATM name \end{description}
\end{Desc}
\begin{Desc}
\item[Returns:]True if is hydrogen, else false \end{Desc}
\index{SimSite3D::PDBBase@{SimSite3D::PDBBase}!read_data@{read\_\-data}}
\index{read_data@{read\_\-data}!SimSite3D::PDBBase@{SimSite3D::PDBBase}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}bool PDBBase::read\_\-data (std::ifstream \& {\em fin}, const bool {\em ignore\_\-alt\-Locs})\hspace{0.3cm}{\tt  [protected]}}\label{classSimSite3D_1_1PDBBase_b11b6aca971d2ce849b16ae28c9f366f}


\begin{Desc}
\item[Parameters:]
\begin{description}
\item[{\em fin}]Reference to an input pdb file stream \item[{\em ignore\_\-alt\-Locs}]If true, use only the first atomic position for each group of alternate locations \end{description}
\end{Desc}
\begin{Desc}
\item[Returns:]True if no error occured during reading, else false \end{Desc}
\index{SimSite3D::PDBBase@{SimSite3D::PDBBase}!set_header@{set\_\-header}}
\index{set_header@{set\_\-header}!SimSite3D::PDBBase@{SimSite3D::PDBBase}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}void PDBBase::set\_\-header (const std::string {\em h})}\label{classSimSite3D_1_1PDBBase_e2de6eb8e6bd77dcca5d0b86847db355}


Set the header. 

\begin{Desc}
\item[Parameters:]
\begin{description}
\item[{\em h}]Header to write first in PDB file \end{description}
\end{Desc}
\index{SimSite3D::PDBBase@{SimSite3D::PDBBase}!write@{write}}
\index{write@{write}!SimSite3D::PDBBase@{SimSite3D::PDBBase}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}bool PDBBase::write (const std::string {\em filename})\hspace{0.3cm}{\tt  [virtual]}}\label{classSimSite3D_1_1PDBBase_e8b78da086bcde015d96f7ac19387925}


Write the atoms to file in PDB format. 

\begin{Desc}
\item[Parameters:]
\begin{description}
\item[{\em filename}]Path to the file to truncate and write PDB atoms lines \end{description}
\end{Desc}
\begin{Desc}
\item[Returns:]True if file could be opened for writing, else false \end{Desc}


Implements \bf{SimSite3D::Coord\-File} \doxyref{p.}{classSimSite3D_1_1CoordFile_dca3f5f45c21f85215dc380e2152b613}.\index{SimSite3D::PDBBase@{SimSite3D::PDBBase}!write_xyzr@{write\_\-xyzr}}
\index{write_xyzr@{write\_\-xyzr}!SimSite3D::PDBBase@{SimSite3D::PDBBase}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}bool PDBBase::write\_\-xyzr (std::ostream \& {\em out}, bool {\em include\_\-metals}, const std::vector$<$ std::string $>$ \& {\em waters})}\label{classSimSite3D_1_1PDBBase_62a92225b2ba833627563c54efd11b7c}


Write as xyzr lines (coordinates + radius). 

\begin{Desc}
\item[Parameters:]
\begin{description}
\item[{\em out}]reference to a valid ostream \item[{\em include\_\-metals}]If false, ignore all metals in PDB file \item[{\em waters}]Vector of water molecules to include \end{description}
\end{Desc}
\begin{Desc}
\item[Returns:]True if file could be opened for writing, else false \end{Desc}


The documentation for this class was generated from the following files:\begin{CompactItemize}
\item 
PDBBase.H\item 
PDBBase.C\end{CompactItemize}
