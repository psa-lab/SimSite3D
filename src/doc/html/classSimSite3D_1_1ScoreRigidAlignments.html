<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>simsite3d: SimSite3D::ScoreRigidAlignments&lt; tier1_SF, tier2_SF, align_T &gt; Class Template Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.4.7 -->
<div class="tabs">
  <ul>
    <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
    <li id="current"><a href="annotated.html"><span>Classes</span></a></li>
    <li><a href="files.html"><span>Files</span></a></li>
  </ul></div>
<div class="tabs">
  <ul>
    <li><a href="annotated.html"><span>Class&nbsp;List</span></a></li>
    <li><a href="hierarchy.html"><span>Class&nbsp;Hierarchy</span></a></li>
    <li><a href="functions.html"><span>Class&nbsp;Members</span></a></li>
  </ul></div>
<div class="nav">
<b>SimSite3D</b>::<a class="el" href="classSimSite3D_1_1ScoreRigidAlignments.html">ScoreRigidAlignments</a></div>
<h1>SimSite3D::ScoreRigidAlignments&lt; tier1_SF, tier2_SF, align_T &gt; Class Template Reference</h1><!-- doxytag: class="SimSite3D::ScoreRigidAlignments" --><!-- doxytag: inherits="SimSite3D::ScoreMapBase" --><code>#include &lt;<a class="el" href="ScoreRigidAlignments_8H-source.html">ScoreRigidAlignments.H</a>&gt;</code>
<p>
<p>Inheritance diagram for SimSite3D::ScoreRigidAlignments&lt; tier1_SF, tier2_SF, align_T &gt;:
<p><center><img src="classSimSite3D_1_1ScoreRigidAlignments.png" usemap="#SimSite3D::ScoreRigidAlignments< tier1_SF, tier2_SF, align_T >_map" border="0" alt=""></center>
<map name="SimSite3D::ScoreRigidAlignments< tier1_SF, tier2_SF, align_T >_map">
<area href="classSimSite3D_1_1ScoreMapBase.html" alt="SimSite3D::ScoreMapBase" shape="rect" coords="574,0,947,24">
<area href="classSimSite3D_1_1EllipsoidalHbondsScore.html" alt="SimSite3D::EllipsoidalHbondsScore" shape="rect" coords="0,112,373,136">
<area href="classSimSite3D_1_1PsuedoLigRmsd.html" alt="SimSite3D::PsuedoLigRmsd" shape="rect" coords="383,112,756,136">
<area href="classSimSite3D_1_1SimplifiedMayoHbondsScore.html" alt="SimSite3D::SimplifiedMayoHbondsScore" shape="rect" coords="766,112,1139,136">
<area href="classSimSite3D_1_1TestScoring.html" alt="SimSite3D::TestScoring" shape="rect" coords="1149,112,1522,136">
</map>
<a href="classSimSite3D_1_1ScoreRigidAlignments-members.html">List of all members.</a><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Public Types</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="b70f013e31f873b416a5c56f027bf72b"></a><!-- doxytag: member="SimSite3D::ScoreRigidAlignments::rigid_align_obj" ref="b70f013e31f873b416a5c56f027bf72b" args="" -->
typedef align_T&nbsp;</td><td class="memItemRight" valign="bottom"><b>rigid_align_obj</b></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="b3f6b33427a5b3e1b3dc7f0f08f7c938"></a><!-- doxytag: member="SimSite3D::ScoreRigidAlignments::rigid_align_vec" ref="b3f6b33427a5b3e1b3dc7f0f08f7c938" args="" -->
typedef std::vector&lt; align_T &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><b>rigid_align_vec</b></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="9197e08d6673598fff132c83c333ad16"></a><!-- doxytag: member="SimSite3D::ScoreRigidAlignments::rigid_align_vi" ref="9197e08d6673598fff132c83c333ad16" args="" -->
typedef rigid_align_vec::iterator&nbsp;</td><td class="memItemRight" valign="bottom"><b>rigid_align_vi</b></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="fd3610658be7ab3a2f7a878c765be502"></a><!-- doxytag: member="SimSite3D::ScoreRigidAlignments::rigid_align_vci" ref="fd3610658be7ab3a2f7a878c765be502" args="" -->
typedef rigid_align_vec::const_iterator&nbsp;</td><td class="memItemRight" valign="bottom"><b>rigid_align_vci</b></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="098b2ec3327dc70824a300518f04b533"></a><!-- doxytag: member="SimSite3D::ScoreRigidAlignments::align_pair" ref="098b2ec3327dc70824a300518f04b533" args="" -->
typedef std::pair&lt; my_float_t,<br>
 rigid_align_vi &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><b>align_pair</b></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="2e5d9eff65db2ea8f48b1b559cff47ec"></a><!-- doxytag: member="SimSite3D::ScoreRigidAlignments::tier1_score_cmp" ref="2e5d9eff65db2ea8f48b1b559cff47ec" args="" -->
typedef tier1_SF::score_cmp&nbsp;</td><td class="memItemRight" valign="bottom"><b>tier1_score_cmp</b></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="4da6a8b332409ba4f92872b12d29f907"></a><!-- doxytag: member="SimSite3D::ScoreRigidAlignments::tier2_score_cmp" ref="4da6a8b332409ba4f92872b12d29f907" args="" -->
typedef tier2_SF::score_cmp&nbsp;</td><td class="memItemRight" valign="bottom"><b>tier2_score_cmp</b></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="8f27b9efe358dc67f0f93da09994267c"></a><!-- doxytag: member="SimSite3D::ScoreRigidAlignments::tier1_score_mmap" ref="8f27b9efe358dc67f0f93da09994267c" args="" -->
typedef std::multimap&lt; my_float_t,<br>
 rigid_align_vi, tier1_score_cmp &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><b>tier1_score_mmap</b></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="c12679175ba1bf637a930445a2c5ecf9"></a><!-- doxytag: member="SimSite3D::ScoreRigidAlignments::tier2_score_mmap" ref="c12679175ba1bf637a930445a2c5ecf9" args="" -->
typedef std::multimap&lt; my_float_t,<br>
 rigid_align_vi, tier2_score_cmp &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><b>tier2_score_mmap</b></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="c7e09e3ab6898aa2255a87ee3f46c8cd"></a><!-- doxytag: member="SimSite3D::ScoreRigidAlignments::tier1_score_mmi" ref="c7e09e3ab6898aa2255a87ee3f46c8cd" args="" -->
typedef tier1_score_mmap::iterator&nbsp;</td><td class="memItemRight" valign="bottom"><b>tier1_score_mmi</b></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="dd2d97ba42597faa5ad8a422bc074154"></a><!-- doxytag: member="SimSite3D::ScoreRigidAlignments::tier2_score_mmi" ref="dd2d97ba42597faa5ad8a422bc074154" args="" -->
typedef tier2_score_mmap::iterator&nbsp;</td><td class="memItemRight" valign="bottom"><b>tier2_score_mmi</b></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="a47352558a34670ebbcd3351717d544f"></a><!-- doxytag: member="SimSite3D::ScoreRigidAlignments::tier1_score_mmci" ref="a47352558a34670ebbcd3351717d544f" args="" -->
typedef tier1_score_mmap::const_iterator&nbsp;</td><td class="memItemRight" valign="bottom"><b>tier1_score_mmci</b></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="c4678b6b9b54e64357d663f1dd69bd36"></a><!-- doxytag: member="SimSite3D::ScoreRigidAlignments::tier2_score_mmci" ref="c4678b6b9b54e64357d663f1dd69bd36" args="" -->
typedef tier2_score_mmap::const_iterator&nbsp;</td><td class="memItemRight" valign="bottom"><b>tier2_score_mmci</b></td></tr>

<tr><td colspan="2"><br><h2>Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSimSite3D_1_1ScoreRigidAlignments.html#106865e65c8b845a550573c22e803d4b">ScoreRigidAlignments</a> (<a class="el" href="classSimSite3D_1_1ModelSitemap.html">ModelSitemap</a> *model_in, const <a class="el" href="classSimSite3D_1_1SearchParameters.html">SearchParameters</a> &amp;params)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Default constructor for scoring methods of rigidly aligned sitemaps.  <a href="#106865e65c8b845a550573c22e803d4b"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="9c5edad1dcd9af6c0150ef7d8429ad47"></a><!-- doxytag: member="SimSite3D::ScoreRigidAlignments::~ScoreRigidAlignments" ref="9c5edad1dcd9af6c0150ef7d8429ad47" args="()" -->
&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSimSite3D_1_1ScoreRigidAlignments.html#9c5edad1dcd9af6c0150ef7d8429ad47">~ScoreRigidAlignments</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">basic destruction <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSimSite3D_1_1ScoreRigidAlignments.html#e078164dfaa7d414d997fc2274de48f3">score_alignments</a> (rigid_align_vec &amp;aligns, <a class="el" href="classSimSite3D_1_1DbaseSitemap.html">DbaseSitemap</a> *dbase_site, std::ostream &amp;results_out=std::cout, std::ostream &amp;rigid_results_out=std::cout)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Main scoring routine.  <a href="#e078164dfaa7d414d997fc2274de48f3"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="3668ef98e3e48111f868cfd5ee139565"></a><!-- doxytag: member="SimSite3D::ScoreRigidAlignments::write_score_header" ref="3668ef98e3e48111f868cfd5ee139565" args="(std::ostream &amp;out)" -->
virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSimSite3D_1_1ScoreRigidAlignments.html#3668ef98e3e48111f868cfd5ee139565">write_score_header</a> (std::ostream &amp;out)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Needs to be called before scoring any alignments. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSimSite3D_1_1ScoreRigidAlignments.html#b8dc3d46b8a573926943ecf0b0a6ae0d">score_tier1_alignments</a> (rigid_align_vec &amp;aligns_in, <a class="el" href="classSimSite3D_1_1DbaseSitemap.html">DbaseSitemap</a> *search, <a class="el" href="classSimSite3D_1_1mol2File.html">mol2File</a> *lig_file, tier1_score_mmap *top_aligns)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Score the alignments for 1 model, search pair of sitemaps.  <a href="#b8dc3d46b8a573926943ecf0b0a6ae0d"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="280977dd9ab68c9c274ede4ad3bf8c1c"></a><!-- doxytag: member="SimSite3D::ScoreRigidAlignments::score_tier2_alignments" ref="280977dd9ab68c9c274ede4ad3bf8c1c" args="(tier1_score_mmap &amp;align_map, DbaseSitemap *dset_site, mol2File *lig_file, const std::string &amp;db_struct_id, const std::string &amp;db_mol_id, tier2_score_mmap *top_aligns, std::ostream &amp;rigid_results_out)" -->
bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSimSite3D_1_1ScoreRigidAlignments.html#280977dd9ab68c9c274ede4ad3bf8c1c">score_tier2_alignments</a> (tier1_score_mmap &amp;align_map, <a class="el" href="classSimSite3D_1_1DbaseSitemap.html">DbaseSitemap</a> *dset_site, <a class="el" href="classSimSite3D_1_1mol2File.html">mol2File</a> *lig_file, const std::string &amp;db_struct_id, const std::string &amp;db_mol_id, tier2_score_mmap *top_aligns, std::ostream &amp;rigid_results_out)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Score the alignments that passed the first sieve. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSimSite3D_1_1ScoreRigidAlignments.html#c843eb1e867692b154abde2456b214d4">score_alignments</a> (rigid_align_vec &amp;aligns_in, <a class="el" href="classSimSite3D_1_1DbaseSitemap.html">DbaseSitemap</a> *dset_site, <a class="el" href="classSimSite3D_1_1mol2File.html">mol2File</a> *lig_file, const std::string &amp;db_struct_id, const std::string &amp;db_mol_id, tier2_score_mmap *top_aligns, std::ostream &amp;rigid_results_out)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Score the alignments for 1 model, dset pair of sitemaps.  <a href="#c843eb1e867692b154abde2456b214d4"></a><br></td></tr>
<tr><td class="memTemplParams" nowrap colspan="2"><a class="anchor" name="f4161aac72991c94e45dcd6b9d6629ff"></a><!-- doxytag: member="SimSite3D::ScoreRigidAlignments::blah" ref="f4161aac72991c94e45dcd6b9d6629ff" args="(rigid_align_vi align, score_T *score_method, cmp_T score_cmp, std::multimap&lt; my_float_t, rigid_align_vi, cmp_T &gt; *top_aligns, mol2File *lig_file, const bool frag_lig_filter, const size_t max_num_aligns, const my_float_t score_cutoff, const bool fine_tune_all, DbaseSitemap *dset_site)" -->
template&lt;class score_T, class cmp_T&gt; </td></tr>
<tr><td class="memTemplItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memTemplItemRight" valign="bottom"><b>blah</b> (rigid_align_vi align, score_T *score_method, cmp_T score_cmp, std::multimap&lt; my_float_t, rigid_align_vi, cmp_T &gt; *top_aligns, <a class="el" href="classSimSite3D_1_1mol2File.html">mol2File</a> *lig_file, const bool frag_lig_filter, const size_t max_num_aligns, const my_float_t score_cutoff, const bool fine_tune_all, <a class="el" href="classSimSite3D_1_1DbaseSitemap.html">DbaseSitemap</a> *dset_site)</td></tr>

<tr><td class="memTemplParams" nowrap colspan="2">template&lt;class score_T&gt; </td></tr>
<tr><td class="memTemplItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="classSimSite3D_1_1ScoreRigidAlignments.html#1d8b66d8f4810212f8f8187c061d74f0">refine_best_alignment</a> (score_T *score_method, tier2_score_mmap *top_aligns, <a class="el" href="classSimSite3D_1_1DbaseSitemap.html">DbaseSitemap</a> *dset_site, <a class="el" href="classSimSite3D_1_1mol2File.html">mol2File</a> *lig_file, const std::string &amp;db_struct_id, const std::string &amp;db_mol_id, std::ostream &amp;rigid_results_out)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="4e0ef1c8fe1ed27a93385ec78ca35bf7"></a><!-- doxytag: member="SimSite3D::ScoreRigidAlignments::score_protein_ligand_interactions" ref="4e0ef1c8fe1ed27a93385ec78ca35bf7" args="(tier2_score_mmap *top_aligns)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSimSite3D_1_1ScoreRigidAlignments.html#4e0ef1c8fe1ed27a93385ec78ca35bf7">score_protein_ligand_interactions</a> (tier2_score_mmap *top_aligns)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Score protein-ligand interactions for the saved alignments. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="4adb8e45da74e0d142fd29e1b1f104dc"></a><!-- doxytag: member="SimSite3D::ScoreRigidAlignments::handle_ligands" ref="4adb8e45da74e0d142fd29e1b1f104dc" args="(tier2_score_mmap &amp;top_aligns, mol2File *lig_file, const std::string &amp;mol_id)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSimSite3D_1_1ScoreRigidAlignments.html#4adb8e45da74e0d142fd29e1b1f104dc">handle_ligands</a> (tier2_score_mmap &amp;top_aligns, <a class="el" href="classSimSite3D_1_1mol2File.html">mol2File</a> *lig_file, const std::string &amp;mol_id)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Handle the ligands for the saved alignments. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="ec86b7fcea8af70b5b4e7cb7dc87383a"></a><!-- doxytag: member="SimSite3D::ScoreRigidAlignments::report_alignments" ref="ec86b7fcea8af70b5b4e7cb7dc87383a" args="(const tier2_score_mmap top_aligns, const bool wrote_ligs, const std::string &amp;db_struct_id, const std::string &amp;db_mol_id, std::ostream &amp;results_out)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSimSite3D_1_1ScoreRigidAlignments.html#ec86b7fcea8af70b5b4e7cb7dc87383a">report_alignments</a> (const tier2_score_mmap top_aligns, const bool wrote_ligs, const std::string &amp;db_struct_id, const std::string &amp;db_mol_id, std::ostream &amp;results_out)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Loop to print out the saved alignments. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSimSite3D_1_1ScoreRigidAlignments.html#6c5e2282df3bb318cb939771eac92754">fine_tune_align</a> (<a class="el" href="classSimSite3D_1_1DbaseSitemap.html">DbaseSitemap</a> *search, rigid_align_obj *align)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="206d3c0c67dd76415e95d0272c254dc3"></a><!-- doxytag: member="SimSite3D::ScoreRigidAlignments::model_struct_id" ref="206d3c0c67dd76415e95d0272c254dc3" args="()" -->
const std::string &amp;&nbsp;</td><td class="memItemRight" valign="bottom"><b>model_struct_id</b> ()</td></tr>

<tr><td colspan="2"><br><h2>Public Attributes</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="b63c437199f354cf7e9ed6d8ffc19016"></a><!-- doxytag: member="SimSite3D::ScoreRigidAlignments::A_tier1_score_class" ref="b63c437199f354cf7e9ed6d8ffc19016" args="" -->
tier1_SF&nbsp;</td><td class="memItemRight" valign="bottom"><b>A_tier1_score_class</b></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="32969be6699fb353d5952e05f63ff87c"></a><!-- doxytag: member="SimSite3D::ScoreRigidAlignments::A_tier2_score_class" ref="32969be6699fb353d5952e05f63ff87c" args="" -->
tier2_SF&nbsp;</td><td class="memItemRight" valign="bottom"><b>A_tier2_score_class</b></td></tr>

<tr><td colspan="2"><br><h2>Protected Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="a2c37b383be18dec552610eacad948fa"></a><!-- doxytag: member="SimSite3D::ScoreRigidAlignments::load_ligand" ref="a2c37b383be18dec552610eacad948fa" args="(const std::string &amp;lig_fname, const std::string &amp;atoms_fname, mol2File **ligand, std::string *struct_id, std::string *mol_id)" -->
bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSimSite3D_1_1ScoreRigidAlignments.html#a2c37b383be18dec552610eacad948fa">load_ligand</a> (const std::string &amp;lig_fname, const std::string &amp;atoms_fname, <a class="el" href="classSimSite3D_1_1mol2File.html">mol2File</a> **ligand, std::string *struct_id, std::string *mol_id)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Load the database ligand file. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="c83e7a7d636e879db4e6f4c135a4a9af"></a><!-- doxytag: member="SimSite3D::ScoreRigidAlignments::get_ligand_fragment" ref="c83e7a7d636e879db4e6f4c135a4a9af" args="(const mol2File &amp;lig_file, const BoundingVolume &amp;site_vol, const CoordFile &amp;interacting_atoms, rigid_align_t *align)" -->
bool&nbsp;</td><td class="memItemRight" valign="bottom"><b>get_ligand_fragment</b> (const <a class="el" href="classSimSite3D_1_1mol2File.html">mol2File</a> &amp;lig_file, const <a class="el" href="classSimSite3D_1_1BoundingVolume.html">BoundingVolume</a> &amp;site_vol, const <a class="el" href="classSimSite3D_1_1CoordFile.html">CoordFile</a> &amp;interacting_atoms, <a class="el" href="classSimSite3D_1_1rigid__align__t.html">rigid_align_t</a> *align)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="eb21d7327bbf06dcc3d4debab2c37be8"></a><!-- doxytag: member="SimSite3D::ScoreRigidAlignments::model" ref="eb21d7327bbf06dcc3d4debab2c37be8" args="()" -->
<a class="el" href="classSimSite3D_1_1ModelSitemap.html">ModelSitemap</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><b>model</b> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="876a98ad43a52edf8cc3ffcbc430c5d1"></a><!-- doxytag: member="SimSite3D::ScoreRigidAlignments::mu" ref="876a98ad43a52edf8cc3ffcbc430c5d1" args="() const " -->
const my_float_t&nbsp;</td><td class="memItemRight" valign="bottom"><b>mu</b> () const </td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="22d5f99e1d0b51848ba4f7398cf65ebf"></a><!-- doxytag: member="SimSite3D::ScoreRigidAlignments::sigma" ref="22d5f99e1d0b51848ba4f7398cf65ebf" args="() const " -->
const my_float_t&nbsp;</td><td class="memItemRight" valign="bottom"><b>sigma</b> () const </td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="92597bda9278cb646d53f52607f11fe3"></a><!-- doxytag: member="SimSite3D::ScoreRigidAlignments::fine_tune_tier2_alignments" ref="92597bda9278cb646d53f52607f11fe3" args="() const " -->
const bool&nbsp;</td><td class="memItemRight" valign="bottom"><b>fine_tune_tier2_alignments</b> () const </td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="df0cb37b9cd68a3ba04aa250fd343a32"></a><!-- doxytag: member="SimSite3D::ScoreRigidAlignments::IK_tests_handle" ref="df0cb37b9cd68a3ba04aa250fd343a32" args="()" -->
<a class="el" href="classSimSite3D_1_1IK__tests.html">IK_tests</a> &amp;&nbsp;</td><td class="memItemRight" valign="bottom"><b>IK_tests_handle</b> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="f59c733a2e67e63da9ae49477949ced2"></a><!-- doxytag: member="SimSite3D::ScoreRigidAlignments::do_IK" ref="f59c733a2e67e63da9ae49477949ced2" args="() const " -->
const bool&nbsp;</td><td class="memItemRight" valign="bottom"><b>do_IK</b> () const </td></tr>

<tr><td colspan="2"><br><h2>Protected Attributes</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="13a5468270fa523e191d1428030fd015"></a><!-- doxytag: member="SimSite3D::ScoreRigidAlignments::A_tier1_score_cmp" ref="13a5468270fa523e191d1428030fd015" args="" -->
tier1_score_cmp&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSimSite3D_1_1ScoreRigidAlignments.html#13a5468270fa523e191d1428030fd015">A_tier1_score_cmp</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get an instance of tier1 cmp. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="f70ab6bb6b22b59758853f0326c8fece"></a><!-- doxytag: member="SimSite3D::ScoreRigidAlignments::A_tier2_score_cmp" ref="f70ab6bb6b22b59758853f0326c8fece" args="" -->
tier2_score_cmp&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSimSite3D_1_1ScoreRigidAlignments.html#f70ab6bb6b22b59758853f0326c8fece">A_tier2_score_cmp</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get an instance of tier2 cmp. <br></td></tr>
<tr><td colspan="2"><br><h2>Private Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSimSite3D_1_1ScoreRigidAlignments.html#6c5bf42335a29f8d6b64c3d163bd79f6">write_ligands</a> (<a class="el" href="classSimSite3D_1_1mol2File.html">mol2File</a> *frag_file, <a class="el" href="classSimSite3D_1_1mol2File.html">mol2File</a> *lig_file, const my_float_t *R, const my_float_t *T, const uint cnt, const std::string struct_id, const std::string output_dir)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Write out the saved ligands and ligand fragments.  <a href="#6c5bf42335a29f8d6b64c3d163bd79f6"></a><br></td></tr>
<tr><td colspan="2"><br><h2>Private Attributes</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="74c601b35ff79d35a71f0fc155aeaab0"></a><!-- doxytag: member="SimSite3D::ScoreRigidAlignments::A_model" ref="74c601b35ff79d35a71f0fc155aeaab0" args="" -->
<a class="el" href="classSimSite3D_1_1ModelSitemap.html">ModelSitemap</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSimSite3D_1_1ScoreRigidAlignments.html#74c601b35ff79d35a71f0fc155aeaab0">A_model</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">The model sitemap -- this is not a constant pointer since we may desire to transform the model rather than dbase site. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="78b29cd62788f0e58a57f1e545b6ca78"></a><!-- doxytag: member="SimSite3D::ScoreRigidAlignments::A_score_method_str" ref="78b29cd62788f0e58a57f1e545b6ca78" args="" -->
std::string&nbsp;</td><td class="memItemRight" valign="bottom"><b>A_score_method_str</b></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="aea65d1bae615f534f6f8543746e423c"></a><!-- doxytag: member="SimSite3D::ScoreRigidAlignments::A_my_IK" ref="aea65d1bae615f534f6f8543746e423c" args="" -->
<a class="el" href="classSimSite3D_1_1IK__tests.html">IK_tests</a>&nbsp;</td><td class="memItemRight" valign="bottom"><b>A_my_IK</b></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="6b70faffcbc103668446433a12d6dd89"></a><!-- doxytag: member="SimSite3D::ScoreRigidAlignments::A_struct_id_field" ref="6b70faffcbc103668446433a12d6dd89" args="" -->
bool&nbsp;</td><td class="memItemRight" valign="bottom"><b>A_struct_id_field</b></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="6107f30f22441300a2d9511fbe0eebb0"></a><!-- doxytag: member="SimSite3D::ScoreRigidAlignments::A_model_struct_id" ref="6107f30f22441300a2d9511fbe0eebb0" args="" -->
std::string&nbsp;</td><td class="memItemRight" valign="bottom"><b>A_model_struct_id</b></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="e2a77ac5a0d9b23d4149c04dde1e445d"></a><!-- doxytag: member="SimSite3D::ScoreRigidAlignments::A_mu" ref="e2a77ac5a0d9b23d4149c04dde1e445d" args="" -->
my_float_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSimSite3D_1_1ScoreRigidAlignments.html#e2a77ac5a0d9b23d4149c04dde1e445d">A_mu</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Mean score of the model sitemap. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="3bd6d7e0444332b61f16bac0f5dad3ed"></a><!-- doxytag: member="SimSite3D::ScoreRigidAlignments::A_sigma" ref="3bd6d7e0444332b61f16bac0f5dad3ed" args="" -->
my_float_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSimSite3D_1_1ScoreRigidAlignments.html#3bd6d7e0444332b61f16bac0f5dad3ed">A_sigma</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Stdev of the model sitemap scores. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="7806e9477e19018757ac9095212e1263"></a><!-- doxytag: member="SimSite3D::ScoreRigidAlignments::A_score_cutoff" ref="7806e9477e19018757ac9095212e1263" args="" -->
my_float_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSimSite3D_1_1ScoreRigidAlignments.html#7806e9477e19018757ac9095212e1263">A_score_cutoff</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Poorest acceptible score. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="896fa695aef8944e5a685ba3ef552b0c"></a><!-- doxytag: member="SimSite3D::ScoreRigidAlignments::A_max_num_aligns" ref="896fa695aef8944e5a685ba3ef552b0c" args="" -->
size_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSimSite3D_1_1ScoreRigidAlignments.html#896fa695aef8944e5a685ba3ef552b0c">A_max_num_aligns</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Number of top scoring hits to keep. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="5412c0788cb1612caa586487861973c1"></a><!-- doxytag: member="SimSite3D::ScoreRigidAlignments::A_max_tier1_aligns" ref="5412c0788cb1612caa586487861973c1" args="" -->
size_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSimSite3D_1_1ScoreRigidAlignments.html#5412c0788cb1612caa586487861973c1">A_max_tier1_aligns</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Max # of alignments to pass to tier2 -- sorted by tier1 cmp. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="f68d236f77307b8d5e4eed409aa573ce"></a><!-- doxytag: member="SimSite3D::ScoreRigidAlignments::A_min_num_atoms" ref="f68d236f77307b8d5e4eed409aa573ce" args="" -->
uint&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSimSite3D_1_1ScoreRigidAlignments.html#f68d236f77307b8d5e4eed409aa573ce">A_min_num_atoms</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">num lig atoms required in model pocket <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="c07f83e7959ea22d965c62791d68fef2"></a><!-- doxytag: member="SimSite3D::ScoreRigidAlignments::normalize_scores" ref="c07f83e7959ea22d965c62791d68fef2" args="" -->
bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSimSite3D_1_1ScoreRigidAlignments.html#c07f83e7959ea22d965c62791d68fef2">normalize_scores</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">True =&gt; normalize scores, otherwise report raw scores. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="3d17d020c019cac00a83e36e22c1ffc6"></a><!-- doxytag: member="SimSite3D::ScoreRigidAlignments::dbase_ligs" ref="3d17d020c019cac00a83e36e22c1ffc6" args="" -->
std::string&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSimSite3D_1_1ScoreRigidAlignments.html#3d17d020c019cac00a83e36e22c1ffc6">dbase_ligs</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Path to the database ligands. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="aeb076a1cf2c91ec5591bf495ab6863f"></a><!-- doxytag: member="SimSite3D::ScoreRigidAlignments::A_proj_output" ref="aeb076a1cf2c91ec5591bf495ab6863f" args="" -->
std::string&nbsp;</td><td class="memItemRight" valign="bottom"><b>A_proj_output</b></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="339bbd1f8e46f0bac4355109e02a5e80"></a><!-- doxytag: member="SimSite3D::ScoreRigidAlignments::A_query_prot" ref="339bbd1f8e46f0bac4355109e02a5e80" args="" -->
<a class="el" href="classSimSite3D_1_1PDBStructure.html">PDBStructure</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSimSite3D_1_1ScoreRigidAlignments.html#339bbd1f8e46f0bac4355109e02a5e80">A_query_prot</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Pointer to the query protein. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="14c7215836a55728fa4225078b31cad7"></a><!-- doxytag: member="SimSite3D::ScoreRigidAlignments::A_write_ligands" ref="14c7215836a55728fa4225078b31cad7" args="" -->
bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSimSite3D_1_1ScoreRigidAlignments.html#14c7215836a55728fa4225078b31cad7">A_write_ligands</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">True =&gt; write ligs and frags, else do not write. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="e979ec8204c97e725aac936bfa63eef2"></a><!-- doxytag: member="SimSite3D::ScoreRigidAlignments::A_fine_tune_tier2_alignments" ref="e979ec8204c97e725aac936bfa63eef2" args="" -->
bool&nbsp;</td><td class="memItemRight" valign="bottom"><b>A_fine_tune_tier2_alignments</b></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="e8677f696bd88d80a5462268e5ba1387"></a><!-- doxytag: member="SimSite3D::ScoreRigidAlignments::A_fine_tune_best_tier2_alignment" ref="e8677f696bd88d80a5462268e5ba1387" args="" -->
bool&nbsp;</td><td class="memItemRight" valign="bottom"><b>A_fine_tune_best_tier2_alignment</b></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="ab1ebc56344decaad88a649ed6d1169c"></a><!-- doxytag: member="SimSite3D::ScoreRigidAlignments::A_do_IK" ref="ab1ebc56344decaad88a649ed6d1169c" args="" -->
bool&nbsp;</td><td class="memItemRight" valign="bottom"><b>A_do_IK</b></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="f98851df27f3c6f9860e32a9821fa632"></a><!-- doxytag: member="SimSite3D::ScoreRigidAlignments::A_orient_num" ref="f98851df27f3c6f9860e32a9821fa632" args="" -->
uint&nbsp;</td><td class="memItemRight" valign="bottom"><b>A_orient_num</b></td></tr>

</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
<h3>template&lt;class tier1_SF, class tier2_SF, class align_T&gt;<br>
 class SimSite3D::ScoreRigidAlignments&lt; tier1_SF, tier2_SF, align_T &gt;</h3>

At the present we are not searching huge databases, but this is the future. We may need to rearrange some of the storage to be more space efficient. The reason for separating the scoring and generation of alignments was to separate the two ideas and remove the code dependancies between generation and scoring of alignments. The thought is to keep the generation of alignments relatively fixed and focus on the scoring of alignments. If the generation of alignments is drastically changed, it is likely the scoring methods will need to be completely rewritten.<p>
notes on template parameters: tier1_SF: must be a derived class of <a class="el" href="classSimSite3D_1_1SitesScoreBase.html">SitesScoreBase</a> tier2_SF: must be a derived class of <a class="el" href="classSimSite3D_1_1SitesScoreBase.html">SitesScoreBase</a> align_T: must be <a class="el" href="classSimSite3D_1_1rigid__align__t.html">rigid_align_t</a> or derived class 
<p>
<hr><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" name="106865e65c8b845a550573c22e803d4b"></a><!-- doxytag: member="SimSite3D::ScoreRigidAlignments::ScoreRigidAlignments" ref="106865e65c8b845a550573c22e803d4b" args="(ModelSitemap *model_in, const SearchParameters &amp;params)" -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class tier1_SF, class tier2_SF, class align_T&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classSimSite3D_1_1ScoreRigidAlignments.html">SimSite3D::ScoreRigidAlignments</a>&lt; tier1_SF, tier2_SF, align_T &gt;::<a class="el" href="classSimSite3D_1_1ScoreRigidAlignments.html">ScoreRigidAlignments</a>           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classSimSite3D_1_1ModelSitemap.html">ModelSitemap</a> *&nbsp;</td>
          <td class="paramname"> <em>model_in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classSimSite3D_1_1SearchParameters.html">SearchParameters</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>params</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Default constructor for scoring methods of rigidly aligned sitemaps. 
<p>
NOTE: once an alignment vector is passed to <a class="el" href="classSimSite3D_1_1ScoreRigidAlignments.html">ScoreRigidAlignments</a> DO NOT manipulate it in any way since <a class="el" href="classSimSite3D_1_1ScoreRigidAlignments.html">ScoreRigidAlignments</a> uses iterators pointing to the vector holding the alignments<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>model_in</em>&nbsp;</td><td>The model sitemap (binding pocket, etc.) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>params</em>&nbsp;</td><td>Reference to the search's runtime parameters </td></tr>
  </table>
</dl>

</div>
</div><p>
<hr><h2>Member Function Documentation</h2>
<a class="anchor" name="6c5e2282df3bb318cb939771eac92754"></a><!-- doxytag: member="SimSite3D::ScoreRigidAlignments::fine_tune_align" ref="6c5e2282df3bb318cb939771eac92754" args="(DbaseSitemap *search, rigid_align_obj *align)" -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class tier1_SF, class tier2_SF, class align_T&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">virtual void <a class="el" href="classSimSite3D_1_1ScoreRigidAlignments.html">SimSite3D::ScoreRigidAlignments</a>&lt; tier1_SF, tier2_SF, align_T &gt;::fine_tune_align           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classSimSite3D_1_1DbaseSitemap.html">DbaseSitemap</a> *&nbsp;</td>
          <td class="paramname"> <em>search</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">rigid_align_obj *&nbsp;</td>
          <td class="paramname"> <em>align</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [inline, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
NOTE: the assumption is the two sites are aligned with respect to the current candidate alignment 
</div>
</div><p>
<a class="anchor" name="1d8b66d8f4810212f8f8187c061d74f0"></a><!-- doxytag: member="SimSite3D::ScoreRigidAlignments::refine_best_alignment" ref="1d8b66d8f4810212f8f8187c061d74f0" args="(score_T *score_method, tier2_score_mmap *top_aligns, DbaseSitemap *dset_site, mol2File *lig_file, const std::string &amp;db_struct_id, const std::string &amp;db_mol_id, std::ostream &amp;rigid_results_out)" -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class tier1_SF, class tier2_SF, class align_T&gt; </div>
<div class="memtemplate">
template&lt;class score_T&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classSimSite3D_1_1ScoreRigidAlignments.html">SimSite3D::ScoreRigidAlignments</a>&lt; tier1_SF, tier2_SF, align_T &gt;::refine_best_alignment           </td>
          <td>(</td>
          <td class="paramtype">score_T *&nbsp;</td>
          <td class="paramname"> <em>score_method</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">tier2_score_mmap *&nbsp;</td>
          <td class="paramname"> <em>top_aligns</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classSimSite3D_1_1DbaseSitemap.html">DbaseSitemap</a> *&nbsp;</td>
          <td class="paramname"> <em>dset_site</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classSimSite3D_1_1mol2File.html">mol2File</a> *&nbsp;</td>
          <td class="paramname"> <em>lig_file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&nbsp;</td>
          <td class="paramname"> <em>db_struct_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&nbsp;</td>
          <td class="paramname"> <em>db_mol_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::ostream &amp;&nbsp;</td>
          <td class="paramname"> <em>rigid_results_out</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
We have a fine mess here -- The goal is to be consistent Issue: When we fine tune after insertion into the map, we cannot update the key. Solution: In this case, we assume only 1 score per site pair will be printed. Dump the entire map and rebuild it with the refined alignment. Deletion and adding of the refined alignment may not be desirable as another alignment could prove to have a more favorable score if the refinement fails. 
</div>
</div><p>
<a class="anchor" name="c843eb1e867692b154abde2456b214d4"></a><!-- doxytag: member="SimSite3D::ScoreRigidAlignments::score_alignments" ref="c843eb1e867692b154abde2456b214d4" args="(rigid_align_vec &amp;aligns_in, DbaseSitemap *dset_site, mol2File *lig_file, const std::string &amp;db_struct_id, const std::string &amp;db_mol_id, tier2_score_mmap *top_aligns, std::ostream &amp;rigid_results_out)" -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class tier1_SF, class tier2_SF, class align_T&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="classSimSite3D_1_1ScoreRigidAlignments.html">SimSite3D::ScoreRigidAlignments</a>&lt; tier1_SF, tier2_SF, align_T &gt;::score_alignments           </td>
          <td>(</td>
          <td class="paramtype">rigid_align_vec &amp;&nbsp;</td>
          <td class="paramname"> <em>aligns_in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classSimSite3D_1_1DbaseSitemap.html">DbaseSitemap</a> *&nbsp;</td>
          <td class="paramname"> <em>dset_site</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classSimSite3D_1_1mol2File.html">mol2File</a> *&nbsp;</td>
          <td class="paramname"> <em>lig_file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&nbsp;</td>
          <td class="paramname"> <em>db_struct_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&nbsp;</td>
          <td class="paramname"> <em>db_mol_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">tier2_score_mmap *&nbsp;</td>
          <td class="paramname"> <em>top_aligns</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::ostream &amp;&nbsp;</td>
          <td class="paramname"> <em>rigid_results_out</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Score the alignments for 1 model, dset pair of sitemaps. 
<p>
NOTE: once an alignment vector is passed to <a class="el" href="classSimSite3D_1_1ScoreRigidAlignments.html">ScoreRigidAlignments</a> DO NOT manipulate it in any way since <a class="el" href="classSimSite3D_1_1ScoreRigidAlignments.html">ScoreRigidAlignments</a> uses iterators pointing to the vector holding the alignments. The vector can be safely modified after this class is no longer needed.<p>
This function is for "single tiered" scoring 
</div>
</div><p>
<a class="anchor" name="e078164dfaa7d414d997fc2274de48f3"></a><!-- doxytag: member="SimSite3D::ScoreRigidAlignments::score_alignments" ref="e078164dfaa7d414d997fc2274de48f3" args="(rigid_align_vec &amp;aligns, DbaseSitemap *dbase_site, std::ostream &amp;results_out=std::cout, std::ostream &amp;rigid_results_out=std::cout)" -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class tier1_SF, class tier2_SF, class align_T&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="classSimSite3D_1_1ScoreRigidAlignments.html">SimSite3D::ScoreRigidAlignments</a>&lt; tier1_SF, tier2_SF, align_T &gt;::score_alignments           </td>
          <td>(</td>
          <td class="paramtype">rigid_align_vec &amp;&nbsp;</td>
          <td class="paramname"> <em>aligns</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classSimSite3D_1_1DbaseSitemap.html">DbaseSitemap</a> *&nbsp;</td>
          <td class="paramname"> <em>dbase_site</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::ostream &amp;&nbsp;</td>
          <td class="paramname"> <em>results_out</em> = <code>std::cout</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::ostream &amp;&nbsp;</td>
          <td class="paramname"> <em>rigid_results_out</em> = <code>std::cout</code></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Main scoring routine. 
<p>
score the alignments for 1 model, search pair of sitemaps<p>
NOTE: once an alignment vector is passed to <a class="el" href="classSimSite3D_1_1ScoreRigidAlignments.html">ScoreRigidAlignments</a> DO NOT manipulate it in any way since <a class="el" href="classSimSite3D_1_1ScoreRigidAlignments.html">ScoreRigidAlignments</a> uses iterators pointing to the vector holding the alignments. The vector can be safely modified after this class is no longer needed. 
</div>
</div><p>
<a class="anchor" name="b8dc3d46b8a573926943ecf0b0a6ae0d"></a><!-- doxytag: member="SimSite3D::ScoreRigidAlignments::score_tier1_alignments" ref="b8dc3d46b8a573926943ecf0b0a6ae0d" args="(rigid_align_vec &amp;aligns_in, DbaseSitemap *search, mol2File *lig_file, tier1_score_mmap *top_aligns)" -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class tier1_SF, class tier2_SF, class align_T&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="classSimSite3D_1_1ScoreRigidAlignments.html">SimSite3D::ScoreRigidAlignments</a>&lt; tier1_SF, tier2_SF, align_T &gt;::score_tier1_alignments           </td>
          <td>(</td>
          <td class="paramtype">rigid_align_vec &amp;&nbsp;</td>
          <td class="paramname"> <em>aligns_in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classSimSite3D_1_1DbaseSitemap.html">DbaseSitemap</a> *&nbsp;</td>
          <td class="paramname"> <em>search</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classSimSite3D_1_1mol2File.html">mol2File</a> *&nbsp;</td>
          <td class="paramname"> <em>lig_file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">tier1_score_mmap *&nbsp;</td>
          <td class="paramname"> <em>top_aligns</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Score the alignments for 1 model, search pair of sitemaps. 
<p>
NOTE: once an alignment vector is passed to <a class="el" href="classSimSite3D_1_1ScoreRigidAlignments.html">ScoreRigidAlignments</a> DO NOT manipulate it in any way since <a class="el" href="classSimSite3D_1_1ScoreRigidAlignments.html">ScoreRigidAlignments</a> uses iterators pointing to the vector holding the alignments. The vector can be safely modified after this class is no longer needed. 
</div>
</div><p>
<a class="anchor" name="6c5bf42335a29f8d6b64c3d163bd79f6"></a><!-- doxytag: member="SimSite3D::ScoreRigidAlignments::write_ligands" ref="6c5bf42335a29f8d6b64c3d163bd79f6" args="(mol2File *frag_file, mol2File *lig_file, const my_float_t *R, const my_float_t *T, const uint cnt, const std::string struct_id, const std::string output_dir)" -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class tier1_SF, class tier2_SF, class align_T&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classSimSite3D_1_1ScoreRigidAlignments.html">SimSite3D::ScoreRigidAlignments</a>&lt; tier1_SF, tier2_SF, align_T &gt;::write_ligands           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classSimSite3D_1_1mol2File.html">mol2File</a> *&nbsp;</td>
          <td class="paramname"> <em>frag_file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classSimSite3D_1_1mol2File.html">mol2File</a> *&nbsp;</td>
          <td class="paramname"> <em>lig_file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const my_float_t *&nbsp;</td>
          <td class="paramname"> <em>R</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const my_float_t *&nbsp;</td>
          <td class="paramname"> <em>T</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint&nbsp;</td>
          <td class="paramname"> <em>cnt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string&nbsp;</td>
          <td class="paramname"> <em>struct_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string&nbsp;</td>
          <td class="paramname"> <em>output_dir</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [inline, private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Write out the saved ligands and ligand fragments. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>output_dir</em>&nbsp;</td><td>Directory to place the ligands and ligand fragments directories </td></tr>
  </table>
</dl>

</div>
</div><p>
<hr>The documentation for this class was generated from the following file:<ul>
<li><a class="el" href="ScoreRigidAlignments_8H-source.html">ScoreRigidAlignments.H</a></ul>
<hr size="1"><address style="align: right;"><small>Generated on Tue Apr 3 23:09:19 2012 for simsite3d by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.4.7 </small></address>
</body>
</html>
