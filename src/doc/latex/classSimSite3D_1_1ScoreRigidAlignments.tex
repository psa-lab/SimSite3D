\section{SimSite3D::Score\-Rigid\-Alignments$<$ tier1\_\-SF, tier2\_\-SF, align\_\-T $>$ Class Template Reference}
\label{classSimSite3D_1_1ScoreRigidAlignments}\index{SimSite3D::ScoreRigidAlignments@{SimSite3D::ScoreRigidAlignments}}
{\tt \#include $<$Score\-Rigid\-Alignments.H$>$}

Inheritance diagram for SimSite3D::Score\-Rigid\-Alignments$<$ tier1\_\-SF, tier2\_\-SF, align\_\-T $>$::\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=1.10236cm]{classSimSite3D_1_1ScoreRigidAlignments}
\end{center}
\end{figure}
\subsection*{Public Types}
\begin{CompactItemize}
\item 
typedef align\_\-T \textbf{rigid\_\-align\_\-obj}\label{classSimSite3D_1_1ScoreRigidAlignments_b70f013e31f873b416a5c56f027bf72b}

\item 
typedef std::vector$<$ align\_\-T $>$ \textbf{rigid\_\-align\_\-vec}\label{classSimSite3D_1_1ScoreRigidAlignments_b3f6b33427a5b3e1b3dc7f0f08f7c938}

\item 
typedef rigid\_\-align\_\-vec::iterator \textbf{rigid\_\-align\_\-vi}\label{classSimSite3D_1_1ScoreRigidAlignments_9197e08d6673598fff132c83c333ad16}

\item 
typedef rigid\_\-align\_\-vec::const\_\-iterator \textbf{rigid\_\-align\_\-vci}\label{classSimSite3D_1_1ScoreRigidAlignments_fd3610658be7ab3a2f7a878c765be502}

\item 
typedef std::pair$<$ my\_\-float\_\-t, rigid\_\-align\_\-vi $>$ \textbf{align\_\-pair}\label{classSimSite3D_1_1ScoreRigidAlignments_098b2ec3327dc70824a300518f04b533}

\item 
typedef tier1\_\-SF::score\_\-cmp \textbf{tier1\_\-score\_\-cmp}\label{classSimSite3D_1_1ScoreRigidAlignments_2e5d9eff65db2ea8f48b1b559cff47ec}

\item 
typedef tier2\_\-SF::score\_\-cmp \textbf{tier2\_\-score\_\-cmp}\label{classSimSite3D_1_1ScoreRigidAlignments_4da6a8b332409ba4f92872b12d29f907}

\item 
typedef std::multimap$<$ my\_\-float\_\-t, rigid\_\-align\_\-vi, tier1\_\-score\_\-cmp $>$ \textbf{tier1\_\-score\_\-mmap}\label{classSimSite3D_1_1ScoreRigidAlignments_8f27b9efe358dc67f0f93da09994267c}

\item 
typedef std::multimap$<$ my\_\-float\_\-t, rigid\_\-align\_\-vi, tier2\_\-score\_\-cmp $>$ \textbf{tier2\_\-score\_\-mmap}\label{classSimSite3D_1_1ScoreRigidAlignments_c12679175ba1bf637a930445a2c5ecf9}

\item 
typedef tier1\_\-score\_\-mmap::iterator \textbf{tier1\_\-score\_\-mmi}\label{classSimSite3D_1_1ScoreRigidAlignments_c7e09e3ab6898aa2255a87ee3f46c8cd}

\item 
typedef tier2\_\-score\_\-mmap::iterator \textbf{tier2\_\-score\_\-mmi}\label{classSimSite3D_1_1ScoreRigidAlignments_dd2d97ba42597faa5ad8a422bc074154}

\item 
typedef tier1\_\-score\_\-mmap::const\_\-iterator \textbf{tier1\_\-score\_\-mmci}\label{classSimSite3D_1_1ScoreRigidAlignments_a47352558a34670ebbcd3351717d544f}

\item 
typedef tier2\_\-score\_\-mmap::const\_\-iterator \textbf{tier2\_\-score\_\-mmci}\label{classSimSite3D_1_1ScoreRigidAlignments_c4678b6b9b54e64357d663f1dd69bd36}

\end{CompactItemize}
\subsection*{Public Member Functions}
\begin{CompactItemize}
\item 
\bf{Score\-Rigid\-Alignments} (\bf{Model\-Sitemap} $\ast$model\_\-in, const \bf{Search\-Parameters} \&params)
\begin{CompactList}\small\item\em Default constructor for scoring methods of rigidly aligned sitemaps. \item\end{CompactList}\item 
\bf{$\sim$Score\-Rigid\-Alignments} ()\label{classSimSite3D_1_1ScoreRigidAlignments_9c5edad1dcd9af6c0150ef7d8429ad47}

\begin{CompactList}\small\item\em basic destruction \item\end{CompactList}\item 
bool \bf{score\_\-alignments} (rigid\_\-align\_\-vec \&aligns, \bf{Dbase\-Sitemap} $\ast$dbase\_\-site, std::ostream \&results\_\-out=std::cout, std::ostream \&rigid\_\-results\_\-out=std::cout)
\begin{CompactList}\small\item\em Main scoring routine. \item\end{CompactList}\item 
virtual void \bf{write\_\-score\_\-header} (std::ostream \&out)\label{classSimSite3D_1_1ScoreRigidAlignments_3668ef98e3e48111f868cfd5ee139565}

\begin{CompactList}\small\item\em Needs to be called before scoring any alignments. \item\end{CompactList}\item 
bool \bf{score\_\-tier1\_\-alignments} (rigid\_\-align\_\-vec \&aligns\_\-in, \bf{Dbase\-Sitemap} $\ast$search, \bf{mol2File} $\ast$lig\_\-file, tier1\_\-score\_\-mmap $\ast$top\_\-aligns)
\begin{CompactList}\small\item\em Score the alignments for 1 model, search pair of sitemaps. \item\end{CompactList}\item 
bool \bf{score\_\-tier2\_\-alignments} (tier1\_\-score\_\-mmap \&align\_\-map, \bf{Dbase\-Sitemap} $\ast$dset\_\-site, \bf{mol2File} $\ast$lig\_\-file, const std::string \&db\_\-struct\_\-id, const std::string \&db\_\-mol\_\-id, tier2\_\-score\_\-mmap $\ast$top\_\-aligns, std::ostream \&rigid\_\-results\_\-out)\label{classSimSite3D_1_1ScoreRigidAlignments_280977dd9ab68c9c274ede4ad3bf8c1c}

\begin{CompactList}\small\item\em Score the alignments that passed the first sieve. \item\end{CompactList}\item 
bool \bf{score\_\-alignments} (rigid\_\-align\_\-vec \&aligns\_\-in, \bf{Dbase\-Sitemap} $\ast$dset\_\-site, \bf{mol2File} $\ast$lig\_\-file, const std::string \&db\_\-struct\_\-id, const std::string \&db\_\-mol\_\-id, tier2\_\-score\_\-mmap $\ast$top\_\-aligns, std::ostream \&rigid\_\-results\_\-out)
\begin{CompactList}\small\item\em Score the alignments for 1 model, dset pair of sitemaps. \item\end{CompactList}\item 
template$<$class score\_\-T, class cmp\_\-T$>$ bool \textbf{blah} (rigid\_\-align\_\-vi align, score\_\-T $\ast$score\_\-method, cmp\_\-T score\_\-cmp, std::multimap$<$ my\_\-float\_\-t, rigid\_\-align\_\-vi, cmp\_\-T $>$ $\ast$top\_\-aligns, \bf{mol2File} $\ast$lig\_\-file, const bool frag\_\-lig\_\-filter, const size\_\-t max\_\-num\_\-aligns, const my\_\-float\_\-t score\_\-cutoff, const bool fine\_\-tune\_\-all, \bf{Dbase\-Sitemap} $\ast$dset\_\-site)\label{classSimSite3D_1_1ScoreRigidAlignments_f4161aac72991c94e45dcd6b9d6629ff}

\item 
template$<$class score\_\-T$>$ void \bf{refine\_\-best\_\-alignment} (score\_\-T $\ast$score\_\-method, tier2\_\-score\_\-mmap $\ast$top\_\-aligns, \bf{Dbase\-Sitemap} $\ast$dset\_\-site, \bf{mol2File} $\ast$lig\_\-file, const std::string \&db\_\-struct\_\-id, const std::string \&db\_\-mol\_\-id, std::ostream \&rigid\_\-results\_\-out)
\item 
void \bf{score\_\-protein\_\-ligand\_\-interactions} (tier2\_\-score\_\-mmap $\ast$top\_\-aligns)\label{classSimSite3D_1_1ScoreRigidAlignments_4e0ef1c8fe1ed27a93385ec78ca35bf7}

\begin{CompactList}\small\item\em Score protein-ligand interactions for the saved alignments. \item\end{CompactList}\item 
void \bf{handle\_\-ligands} (tier2\_\-score\_\-mmap \&top\_\-aligns, \bf{mol2File} $\ast$lig\_\-file, const std::string \&mol\_\-id)\label{classSimSite3D_1_1ScoreRigidAlignments_4adb8e45da74e0d142fd29e1b1f104dc}

\begin{CompactList}\small\item\em Handle the ligands for the saved alignments. \item\end{CompactList}\item 
void \bf{report\_\-alignments} (const tier2\_\-score\_\-mmap top\_\-aligns, const bool wrote\_\-ligs, const std::string \&db\_\-struct\_\-id, const std::string \&db\_\-mol\_\-id, std::ostream \&results\_\-out)\label{classSimSite3D_1_1ScoreRigidAlignments_ec86b7fcea8af70b5b4e7cb7dc87383a}

\begin{CompactList}\small\item\em Loop to print out the saved alignments. \item\end{CompactList}\item 
virtual void \bf{fine\_\-tune\_\-align} (\bf{Dbase\-Sitemap} $\ast$search, rigid\_\-align\_\-obj $\ast$align)
\item 
const std::string \& \textbf{model\_\-struct\_\-id} ()\label{classSimSite3D_1_1ScoreRigidAlignments_206d3c0c67dd76415e95d0272c254dc3}

\end{CompactItemize}
\subsection*{Public Attributes}
\begin{CompactItemize}
\item 
tier1\_\-SF \textbf{A\_\-tier1\_\-score\_\-class}\label{classSimSite3D_1_1ScoreRigidAlignments_b63c437199f354cf7e9ed6d8ffc19016}

\item 
tier2\_\-SF \textbf{A\_\-tier2\_\-score\_\-class}\label{classSimSite3D_1_1ScoreRigidAlignments_32969be6699fb353d5952e05f63ff87c}

\end{CompactItemize}
\subsection*{Protected Member Functions}
\begin{CompactItemize}
\item 
bool \bf{load\_\-ligand} (const std::string \&lig\_\-fname, const std::string \&atoms\_\-fname, \bf{mol2File} $\ast$$\ast$ligand, std::string $\ast$struct\_\-id, std::string $\ast$mol\_\-id)\label{classSimSite3D_1_1ScoreRigidAlignments_a2c37b383be18dec552610eacad948fa}

\begin{CompactList}\small\item\em Load the database ligand file. \item\end{CompactList}\item 
bool \textbf{get\_\-ligand\_\-fragment} (const \bf{mol2File} \&lig\_\-file, const \bf{Bounding\-Volume} \&site\_\-vol, const \bf{Coord\-File} \&interacting\_\-atoms, \bf{rigid\_\-align\_\-t} $\ast$align)\label{classSimSite3D_1_1ScoreRigidAlignments_c83e7a7d636e879db4e6f4c135a4a9af}

\item 
\bf{Model\-Sitemap} $\ast$ \textbf{model} ()\label{classSimSite3D_1_1ScoreRigidAlignments_eb21d7327bbf06dcc3d4debab2c37be8}

\item 
const my\_\-float\_\-t \textbf{mu} () const \label{classSimSite3D_1_1ScoreRigidAlignments_876a98ad43a52edf8cc3ffcbc430c5d1}

\item 
const my\_\-float\_\-t \textbf{sigma} () const \label{classSimSite3D_1_1ScoreRigidAlignments_22d5f99e1d0b51848ba4f7398cf65ebf}

\item 
const bool \textbf{fine\_\-tune\_\-tier2\_\-alignments} () const \label{classSimSite3D_1_1ScoreRigidAlignments_92597bda9278cb646d53f52607f11fe3}

\item 
\bf{IK\_\-tests} \& \textbf{IK\_\-tests\_\-handle} ()\label{classSimSite3D_1_1ScoreRigidAlignments_df0cb37b9cd68a3ba04aa250fd343a32}

\item 
const bool \textbf{do\_\-IK} () const \label{classSimSite3D_1_1ScoreRigidAlignments_f59c733a2e67e63da9ae49477949ced2}

\end{CompactItemize}
\subsection*{Protected Attributes}
\begin{CompactItemize}
\item 
tier1\_\-score\_\-cmp \bf{A\_\-tier1\_\-score\_\-cmp}\label{classSimSite3D_1_1ScoreRigidAlignments_13a5468270fa523e191d1428030fd015}

\begin{CompactList}\small\item\em Get an instance of tier1 cmp. \item\end{CompactList}\item 
tier2\_\-score\_\-cmp \bf{A\_\-tier2\_\-score\_\-cmp}\label{classSimSite3D_1_1ScoreRigidAlignments_f70ab6bb6b22b59758853f0326c8fece}

\begin{CompactList}\small\item\em Get an instance of tier2 cmp. \item\end{CompactList}\end{CompactItemize}
\subsection*{Private Member Functions}
\begin{CompactItemize}
\item 
void \bf{write\_\-ligands} (\bf{mol2File} $\ast$frag\_\-file, \bf{mol2File} $\ast$lig\_\-file, const my\_\-float\_\-t $\ast$R, const my\_\-float\_\-t $\ast$T, const uint cnt, const std::string struct\_\-id, const std::string output\_\-dir)
\begin{CompactList}\small\item\em Write out the saved ligands and ligand fragments. \item\end{CompactList}\end{CompactItemize}
\subsection*{Private Attributes}
\begin{CompactItemize}
\item 
\bf{Model\-Sitemap} $\ast$ \bf{A\_\-model}\label{classSimSite3D_1_1ScoreRigidAlignments_74c601b35ff79d35a71f0fc155aeaab0}

\begin{CompactList}\small\item\em The model sitemap -- this is not a constant pointer since we may desire to transform the model rather than dbase site. \item\end{CompactList}\item 
std::string \textbf{A\_\-score\_\-method\_\-str}\label{classSimSite3D_1_1ScoreRigidAlignments_78b29cd62788f0e58a57f1e545b6ca78}

\item 
\bf{IK\_\-tests} \textbf{A\_\-my\_\-IK}\label{classSimSite3D_1_1ScoreRigidAlignments_aea65d1bae615f534f6f8543746e423c}

\item 
bool \textbf{A\_\-struct\_\-id\_\-field}\label{classSimSite3D_1_1ScoreRigidAlignments_6b70faffcbc103668446433a12d6dd89}

\item 
std::string \textbf{A\_\-model\_\-struct\_\-id}\label{classSimSite3D_1_1ScoreRigidAlignments_6107f30f22441300a2d9511fbe0eebb0}

\item 
my\_\-float\_\-t \bf{A\_\-mu}\label{classSimSite3D_1_1ScoreRigidAlignments_e2a77ac5a0d9b23d4149c04dde1e445d}

\begin{CompactList}\small\item\em Mean score of the model sitemap. \item\end{CompactList}\item 
my\_\-float\_\-t \bf{A\_\-sigma}\label{classSimSite3D_1_1ScoreRigidAlignments_3bd6d7e0444332b61f16bac0f5dad3ed}

\begin{CompactList}\small\item\em Stdev of the model sitemap scores. \item\end{CompactList}\item 
my\_\-float\_\-t \bf{A\_\-score\_\-cutoff}\label{classSimSite3D_1_1ScoreRigidAlignments_7806e9477e19018757ac9095212e1263}

\begin{CompactList}\small\item\em Poorest acceptible score. \item\end{CompactList}\item 
size\_\-t \bf{A\_\-max\_\-num\_\-aligns}\label{classSimSite3D_1_1ScoreRigidAlignments_896fa695aef8944e5a685ba3ef552b0c}

\begin{CompactList}\small\item\em Number of top scoring hits to keep. \item\end{CompactList}\item 
size\_\-t \bf{A\_\-max\_\-tier1\_\-aligns}\label{classSimSite3D_1_1ScoreRigidAlignments_5412c0788cb1612caa586487861973c1}

\begin{CompactList}\small\item\em Max \# of alignments to pass to tier2 -- sorted by tier1 cmp. \item\end{CompactList}\item 
uint \bf{A\_\-min\_\-num\_\-atoms}\label{classSimSite3D_1_1ScoreRigidAlignments_f68d236f77307b8d5e4eed409aa573ce}

\begin{CompactList}\small\item\em num lig atoms required in model pocket \item\end{CompactList}\item 
bool \bf{normalize\_\-scores}\label{classSimSite3D_1_1ScoreRigidAlignments_c07f83e7959ea22d965c62791d68fef2}

\begin{CompactList}\small\item\em True =$>$ normalize scores, otherwise report raw scores. \item\end{CompactList}\item 
std::string \bf{dbase\_\-ligs}\label{classSimSite3D_1_1ScoreRigidAlignments_3d17d020c019cac00a83e36e22c1ffc6}

\begin{CompactList}\small\item\em Path to the database ligands. \item\end{CompactList}\item 
std::string \textbf{A\_\-proj\_\-output}\label{classSimSite3D_1_1ScoreRigidAlignments_aeb076a1cf2c91ec5591bf495ab6863f}

\item 
\bf{PDBStructure} $\ast$ \bf{A\_\-query\_\-prot}\label{classSimSite3D_1_1ScoreRigidAlignments_339bbd1f8e46f0bac4355109e02a5e80}

\begin{CompactList}\small\item\em Pointer to the query protein. \item\end{CompactList}\item 
bool \bf{A\_\-write\_\-ligands}\label{classSimSite3D_1_1ScoreRigidAlignments_14c7215836a55728fa4225078b31cad7}

\begin{CompactList}\small\item\em True =$>$ write ligs and frags, else do not write. \item\end{CompactList}\item 
bool \textbf{A\_\-fine\_\-tune\_\-tier2\_\-alignments}\label{classSimSite3D_1_1ScoreRigidAlignments_e979ec8204c97e725aac936bfa63eef2}

\item 
bool \textbf{A\_\-fine\_\-tune\_\-best\_\-tier2\_\-alignment}\label{classSimSite3D_1_1ScoreRigidAlignments_e8677f696bd88d80a5462268e5ba1387}

\item 
bool \textbf{A\_\-do\_\-IK}\label{classSimSite3D_1_1ScoreRigidAlignments_ab1ebc56344decaad88a649ed6d1169c}

\item 
uint \textbf{A\_\-orient\_\-num}\label{classSimSite3D_1_1ScoreRigidAlignments_f98851df27f3c6f9860e32a9821fa632}

\end{CompactItemize}


\subsection{Detailed Description}
\subsubsection*{template$<$class tier1\_\-SF, class tier2\_\-SF, class align\_\-T$>$ class SimSite3D::Score\-Rigid\-Alignments$<$ tier1\_\-SF, tier2\_\-SF, align\_\-T $>$}

At the present we are not searching huge databases, but this is the future. We may need to rearrange some of the storage to be more space efficient. The reason for separating the scoring and generation of alignments was to separate the two ideas and remove the code dependancies between generation and scoring of alignments. The thought is to keep the generation of alignments relatively fixed and focus on the scoring of alignments. If the generation of alignments is drastically changed, it is likely the scoring methods will need to be completely rewritten.

notes on template parameters: tier1\_\-SF: must be a derived class of \doxyref{Sites\-Score\-Base}{p.}{classSimSite3D_1_1SitesScoreBase} tier2\_\-SF: must be a derived class of \doxyref{Sites\-Score\-Base}{p.}{classSimSite3D_1_1SitesScoreBase} align\_\-T: must be \doxyref{rigid\_\-align\_\-t}{p.}{classSimSite3D_1_1rigid__align__t} or derived class 



\subsection{Constructor \& Destructor Documentation}
\index{SimSite3D::ScoreRigidAlignments@{SimSite3D::Score\-Rigid\-Alignments}!ScoreRigidAlignments@{ScoreRigidAlignments}}
\index{ScoreRigidAlignments@{ScoreRigidAlignments}!SimSite3D::ScoreRigidAlignments@{SimSite3D::Score\-Rigid\-Alignments}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}template$<$class tier1\_\-SF, class tier2\_\-SF, class align\_\-T$>$ \bf{SimSite3D::Score\-Rigid\-Alignments}$<$ tier1\_\-SF, tier2\_\-SF, align\_\-T $>$::\bf{Score\-Rigid\-Alignments} (\bf{Model\-Sitemap} $\ast$ {\em model\_\-in}, const \bf{Search\-Parameters} \& {\em params})\hspace{0.3cm}{\tt  [inline]}}\label{classSimSite3D_1_1ScoreRigidAlignments_106865e65c8b845a550573c22e803d4b}


Default constructor for scoring methods of rigidly aligned sitemaps. 

NOTE: once an alignment vector is passed to \doxyref{Score\-Rigid\-Alignments}{p.}{classSimSite3D_1_1ScoreRigidAlignments} DO NOT manipulate it in any way since \doxyref{Score\-Rigid\-Alignments}{p.}{classSimSite3D_1_1ScoreRigidAlignments} uses iterators pointing to the vector holding the alignments

\begin{Desc}
\item[Parameters:]
\begin{description}
\item[{\em model\_\-in}]The model sitemap (binding pocket, etc.) \item[{\em params}]Reference to the search's runtime parameters \end{description}
\end{Desc}


\subsection{Member Function Documentation}
\index{SimSite3D::ScoreRigidAlignments@{SimSite3D::Score\-Rigid\-Alignments}!fine_tune_align@{fine\_\-tune\_\-align}}
\index{fine_tune_align@{fine\_\-tune\_\-align}!SimSite3D::ScoreRigidAlignments@{SimSite3D::Score\-Rigid\-Alignments}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}template$<$class tier1\_\-SF, class tier2\_\-SF, class align\_\-T$>$ virtual void \bf{SimSite3D::Score\-Rigid\-Alignments}$<$ tier1\_\-SF, tier2\_\-SF, align\_\-T $>$::fine\_\-tune\_\-align (\bf{Dbase\-Sitemap} $\ast$ {\em search}, rigid\_\-align\_\-obj $\ast$ {\em align})\hspace{0.3cm}{\tt  [inline, virtual]}}\label{classSimSite3D_1_1ScoreRigidAlignments_6c5e2282df3bb318cb939771eac92754}


NOTE: the assumption is the two sites are aligned with respect to the current candidate alignment \index{SimSite3D::ScoreRigidAlignments@{SimSite3D::Score\-Rigid\-Alignments}!refine_best_alignment@{refine\_\-best\_\-alignment}}
\index{refine_best_alignment@{refine\_\-best\_\-alignment}!SimSite3D::ScoreRigidAlignments@{SimSite3D::Score\-Rigid\-Alignments}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}template$<$class tier1\_\-SF, class tier2\_\-SF, class align\_\-T$>$ template$<$class score\_\-T$>$ void \bf{SimSite3D::Score\-Rigid\-Alignments}$<$ tier1\_\-SF, tier2\_\-SF, align\_\-T $>$::refine\_\-best\_\-alignment (score\_\-T $\ast$ {\em score\_\-method}, tier2\_\-score\_\-mmap $\ast$ {\em top\_\-aligns}, \bf{Dbase\-Sitemap} $\ast$ {\em dset\_\-site}, \bf{mol2File} $\ast$ {\em lig\_\-file}, const std::string \& {\em db\_\-struct\_\-id}, const std::string \& {\em db\_\-mol\_\-id}, std::ostream \& {\em rigid\_\-results\_\-out})\hspace{0.3cm}{\tt  [inline]}}\label{classSimSite3D_1_1ScoreRigidAlignments_1d8b66d8f4810212f8f8187c061d74f0}


We have a fine mess here -- The goal is to be consistent Issue: When we fine tune after insertion into the map, we cannot update the key. Solution: In this case, we assume only 1 score per site pair will be printed. Dump the entire map and rebuild it with the refined alignment. Deletion and adding of the refined alignment may not be desirable as another alignment could prove to have a more favorable score if the refinement fails. \index{SimSite3D::ScoreRigidAlignments@{SimSite3D::Score\-Rigid\-Alignments}!score_alignments@{score\_\-alignments}}
\index{score_alignments@{score\_\-alignments}!SimSite3D::ScoreRigidAlignments@{SimSite3D::Score\-Rigid\-Alignments}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}template$<$class tier1\_\-SF, class tier2\_\-SF, class align\_\-T$>$ bool \bf{SimSite3D::Score\-Rigid\-Alignments}$<$ tier1\_\-SF, tier2\_\-SF, align\_\-T $>$::score\_\-alignments (rigid\_\-align\_\-vec \& {\em aligns\_\-in}, \bf{Dbase\-Sitemap} $\ast$ {\em dset\_\-site}, \bf{mol2File} $\ast$ {\em lig\_\-file}, const std::string \& {\em db\_\-struct\_\-id}, const std::string \& {\em db\_\-mol\_\-id}, tier2\_\-score\_\-mmap $\ast$ {\em top\_\-aligns}, std::ostream \& {\em rigid\_\-results\_\-out})\hspace{0.3cm}{\tt  [inline]}}\label{classSimSite3D_1_1ScoreRigidAlignments_c843eb1e867692b154abde2456b214d4}


Score the alignments for 1 model, dset pair of sitemaps. 

NOTE: once an alignment vector is passed to \doxyref{Score\-Rigid\-Alignments}{p.}{classSimSite3D_1_1ScoreRigidAlignments} DO NOT manipulate it in any way since \doxyref{Score\-Rigid\-Alignments}{p.}{classSimSite3D_1_1ScoreRigidAlignments} uses iterators pointing to the vector holding the alignments. The vector can be safely modified after this class is no longer needed.

This function is for \char`\"{}single tiered\char`\"{} scoring \index{SimSite3D::ScoreRigidAlignments@{SimSite3D::Score\-Rigid\-Alignments}!score_alignments@{score\_\-alignments}}
\index{score_alignments@{score\_\-alignments}!SimSite3D::ScoreRigidAlignments@{SimSite3D::Score\-Rigid\-Alignments}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}template$<$class tier1\_\-SF, class tier2\_\-SF, class align\_\-T$>$ bool \bf{SimSite3D::Score\-Rigid\-Alignments}$<$ tier1\_\-SF, tier2\_\-SF, align\_\-T $>$::score\_\-alignments (rigid\_\-align\_\-vec \& {\em aligns}, \bf{Dbase\-Sitemap} $\ast$ {\em dbase\_\-site}, std::ostream \& {\em results\_\-out} = {\tt std::cout}, std::ostream \& {\em rigid\_\-results\_\-out} = {\tt std::cout})\hspace{0.3cm}{\tt  [inline]}}\label{classSimSite3D_1_1ScoreRigidAlignments_e078164dfaa7d414d997fc2274de48f3}


Main scoring routine. 

score the alignments for 1 model, search pair of sitemaps

NOTE: once an alignment vector is passed to \doxyref{Score\-Rigid\-Alignments}{p.}{classSimSite3D_1_1ScoreRigidAlignments} DO NOT manipulate it in any way since \doxyref{Score\-Rigid\-Alignments}{p.}{classSimSite3D_1_1ScoreRigidAlignments} uses iterators pointing to the vector holding the alignments. The vector can be safely modified after this class is no longer needed. \index{SimSite3D::ScoreRigidAlignments@{SimSite3D::Score\-Rigid\-Alignments}!score_tier1_alignments@{score\_\-tier1\_\-alignments}}
\index{score_tier1_alignments@{score\_\-tier1\_\-alignments}!SimSite3D::ScoreRigidAlignments@{SimSite3D::Score\-Rigid\-Alignments}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}template$<$class tier1\_\-SF, class tier2\_\-SF, class align\_\-T$>$ bool \bf{SimSite3D::Score\-Rigid\-Alignments}$<$ tier1\_\-SF, tier2\_\-SF, align\_\-T $>$::score\_\-tier1\_\-alignments (rigid\_\-align\_\-vec \& {\em aligns\_\-in}, \bf{Dbase\-Sitemap} $\ast$ {\em search}, \bf{mol2File} $\ast$ {\em lig\_\-file}, tier1\_\-score\_\-mmap $\ast$ {\em top\_\-aligns})\hspace{0.3cm}{\tt  [inline]}}\label{classSimSite3D_1_1ScoreRigidAlignments_b8dc3d46b8a573926943ecf0b0a6ae0d}


Score the alignments for 1 model, search pair of sitemaps. 

NOTE: once an alignment vector is passed to \doxyref{Score\-Rigid\-Alignments}{p.}{classSimSite3D_1_1ScoreRigidAlignments} DO NOT manipulate it in any way since \doxyref{Score\-Rigid\-Alignments}{p.}{classSimSite3D_1_1ScoreRigidAlignments} uses iterators pointing to the vector holding the alignments. The vector can be safely modified after this class is no longer needed. \index{SimSite3D::ScoreRigidAlignments@{SimSite3D::Score\-Rigid\-Alignments}!write_ligands@{write\_\-ligands}}
\index{write_ligands@{write\_\-ligands}!SimSite3D::ScoreRigidAlignments@{SimSite3D::Score\-Rigid\-Alignments}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}template$<$class tier1\_\-SF, class tier2\_\-SF, class align\_\-T$>$ void \bf{SimSite3D::Score\-Rigid\-Alignments}$<$ tier1\_\-SF, tier2\_\-SF, align\_\-T $>$::write\_\-ligands (\bf{mol2File} $\ast$ {\em frag\_\-file}, \bf{mol2File} $\ast$ {\em lig\_\-file}, const my\_\-float\_\-t $\ast$ {\em R}, const my\_\-float\_\-t $\ast$ {\em T}, const uint {\em cnt}, const std::string {\em struct\_\-id}, const std::string {\em output\_\-dir})\hspace{0.3cm}{\tt  [inline, private]}}\label{classSimSite3D_1_1ScoreRigidAlignments_6c5bf42335a29f8d6b64c3d163bd79f6}


Write out the saved ligands and ligand fragments. 

\begin{Desc}
\item[Parameters:]
\begin{description}
\item[{\em output\_\-dir}]Directory to place the ligands and ligand fragments directories \end{description}
\end{Desc}


The documentation for this class was generated from the following file:\begin{CompactItemize}
\item 
Score\-Rigid\-Alignments.H\end{CompactItemize}
